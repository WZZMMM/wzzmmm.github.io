<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


:root {
  --mermaid-theme: night;
}

[lang='mermaid'] .label {
  color: #333;
}

/* CSS Document */

/** code highlight */

.cm-s-inner .cm-variable,
.cm-s-inner .cm-operator,
.cm-s-inner .cm-property {
    color: #b8bfc6;
}

.cm-s-inner .cm-keyword {
    color: #C88FD0;
}

.cm-s-inner .cm-tag {
    color: #7DF46A;
}

.cm-s-inner .cm-attribute {
    color: #7575E4;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 1px solid #b8bfc6;
    z-index: 3;
}

.cm-s-inner .cm-string {
    color: #D26B6B;
}

.cm-s-inner .cm-comment,
.cm-s-inner.cm-comment {
    color: #DA924A;
}

.cm-s-inner .cm-header,
.cm-s-inner .cm-def,
.cm-s-inner.cm-header,
.cm-s-inner.cm-def {
    color: #8d8df0;
}

.cm-s-inner .cm-quote,
.cm-s-inner.cm-quote {
    color: #57ac57;
}

.cm-s-inner .cm-hr {
    color: #d8d5d5;
}

.cm-s-inner .cm-link {
    color: #d3d3ef;
}

.cm-s-inner .cm-negative {
    color: #d95050;
}

.cm-s-inner .cm-positive {
    color: #50e650;
}

.cm-s-inner .cm-string-2 {
    color: #f50;
}

.cm-s-inner .cm-meta,
.cm-s-inner .cm-qualifier {
    color: #b7b3b3;
}

.cm-s-inner .cm-builtin {
    color: #f3b3f8;
}

.cm-s-inner .cm-bracket {
    color: #997;
}

.cm-s-inner .cm-atom,
.cm-s-inner.cm-atom {
    color: #84B6CB;
}

.cm-s-inner .cm-number {
    color: #64AB8F;
}

.cm-s-inner .cm-variable {
    color: #b8bfc6;
}

.cm-s-inner .cm-variable-2 {
    color: #9FBAD5;
}

.cm-s-inner .cm-variable-3 {
    color: #1cc685;
}

.CodeMirror-selectedtext,
.CodeMirror-selected {
    background: #4a89dc;
    color: #fff !important;
    text-shadow: none;
}

.CodeMirror-gutters {
    border-right: none;
}

/* CSS Document */

/** markdown source **/
.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property
{
    color: #cebcca;
}

.CodeMirror.cm-s-typora-default div.CodeMirror-cursor{
    border-left: 3px solid #b8bfc6;
}

.cm-s-typora-default .cm-comment {
    color: #9FB1FF;
}

.cm-s-typora-default .cm-string {
    color: #A7A7D9
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
    color: #848695;
    font-style: italic;
}

.cm-s-typora-default .cm-link {
    color: #95B94B;
}

.cm-s-typora-default .CodeMirror-activeline-background {
    background: rgba(51, 51, 51, 0.72);
}

.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code {
	color: #8aa1e1;
}@import "";
@import "";
@import "";

:root {
    --bg-color:  #363B40;
    --side-bar-bg-color: #2E3033;
    --text-color: #b8bfc6;

    --select-text-bg-color:#4a89dc;

    --item-hover-bg-color: #0a0d16;
    --control-text-color: #b7b7b7;
    --control-text-hover-color: #eee;
    --window-border: 1px solid #555;

    --active-file-bg-color: rgb(34, 34, 34);
    --active-file-border-color: #8d8df0;

    --primary-color: #a3d5fe;

    --active-file-text-color: white;
    --item-hover-bg-color: #70717d;
    --item-hover-text-color: white;
    --primary-color: #6dc1e7;

    --rawblock-edit-panel-bd: #333;

    --search-select-bg-color: #428bca;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

html,
body {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    background: #363B40;
    background: var(--bg-color);
    fill: currentColor;
    line-height: 1.625rem;
}

#write {
    max-width: 914px;
}


@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

html,
body,
button,
input,
select,
textarea,
div.code-tooltip-content {
    color: #b8bfc6;
    border-color: transparent;
}

div.code-tooltip,
.md-hover-tip .md-arrow:after {
    background: #333;
}

.native-window #md-notification {
    border: 1px solid #70717d;
}

.popover.bottom > .arrow:after {
    border-bottom-color: #333;
}

html,
body,
button,
input,
select,
textarea {
    font-family: "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
}

hr {
    height: 2px;
    border: 0;
    margin: 24px 0 !important;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: "Lucida Grande", "Corbel", sans-serif;
    font-weight: normal;
    clear: both;
    -ms-word-wrap: break-word;
    word-wrap: break-word;
    margin: 0;
    padding: 0;
    color: #DEDEDE
}

h1 {
    font-size: 2.5rem;
    /* 36px */
    line-height: 2.75rem;
    /* 40px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1.5px;
}

h2 {
    font-size: 1.63rem;
    /* 24px */
    line-height: 1.875rem;
    /* 30px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h3 {
    font-size: 1.17rem;
    /* 18px */
    line-height: 1.5rem;
    /* 24px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h4 {
    font-size: 1.12rem;
    /* 16px */
    line-height: 1.375rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    color: white;
}

h5 {
    font-size: 0.97rem;
    /* 16px */
    line-height: 1.25rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    font-weight: bold;
}

h6 {
    font-size: 0.93rem;
    /* 16px */
    line-height: 1rem;
    /* 16px */
    margin-bottom: 0.75rem;
    color: white;
}

@media (min-width: 980px) {
    h3.md-focus:before,
    h4.md-focus:before,
    h5.md-focus:before,
    h6.md-focus:before {
        color: #ddd;
        border: 1px solid #ddd;
        border-radius: 3px;
        position: absolute;
        left: -1.642857143rem;
        top: .357142857rem;
        float: left;
        font-size: 9px;
        padding-left: 2px;
        padding-right: 2px;
        vertical-align: bottom;
        font-weight: normal;
        line-height: normal;
    }

    h3.md-focus:before {
        content: 'h3';
    }

    h4.md-focus:before {
        content: 'h4';
    }

    h5.md-focus:before {
        content: 'h5';
        top: 0px;
    }

    h6.md-focus:before {
        content: 'h6';
        top: 0px;
    }
}

a {
    text-decoration: none;
    outline: 0;
}

a:hover {
    outline: 0;
}

a:focus {
    outline: thin dotted;
}

sup.md-footnote {
    background-color: #555;
    color: #ddd;
}

p {
    -ms-word-wrap: break-word;
    word-wrap: break-word;
}

p,
ul,
dd,
ol,
hr,
address,
pre,
table,
iframe,
.wp-caption,
.wp-audio-shortcode,
.wp-video-shortcode {
    margin-top: 0;
    margin-bottom: 1.5rem;
    /* 24px */
}

audio:not([controls]) {
    display: none;
}

[hidden] {
    display: none;
}

::-moz-selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

*.in-text-selection,
::selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

ul,
ol {
    padding: 0 0 0 1.875rem;
    /* 30px */
}

ul {
    list-style: square;
}

ol {
    list-style: decimal;
}

ul ul,
ol ol,
ul ol,
ol ul {
    margin: 0;
}

b,
th,
dt,
strong {
    font-weight: bold;
}

i,
em,
dfn,
cite {
    font-style: italic;
}

blockquote {
    padding-left: 1.875rem;
    margin: 0 0 1.875rem 1.875rem;
    border-left: solid 2px #474d54;
    padding-left: 30px;
    margin-top: 35px;
}

pre,
code,
kbd,
tt,
var {
    font-size: 0.875em;
    font-family: Monaco, Consolas, "Andale Mono", "DejaVu Sans Mono", monospace;
}

code,
tt,
var {
    background: rgba(0, 0, 0, 0.05);
}

kbd {
    padding: 2px 4px;
    font-size: 90%;
    color: #fff;
    background-color: #333;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 rgba(0,0,0,.25);
}

pre.md-fences {
    padding: 10px 10px 10px 30px;
    margin-bottom: 20px;
    background: #333;
}

.CodeMirror-gutters {
    background: #333;
    border-right: 1px solid transparent;
}

.enable-diagrams pre.md-fences[lang="sequence"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="flow"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="mermaid"] .code-tooltip {
    bottom: -2.2em;
    right: 4px;
}

code,
kbd,
tt,
var {
    padding: 2px 5px;
}

table {
    max-width: 100%;
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
}

th,
td {
    padding: 5px 10px;
    vertical-align: top;
}

a {
    -webkit-transition: all .2s ease-in-out;
    transition: all .2s ease-in-out;
}

hr {
    background: #474d54;
    /* variable */
}

h1 {
    margin-top: 2em;
}

a {
    color: #e0e0e0;
    text-decoration: underline;
}

a:hover {
    color: #fff;
}

.md-inline-math script {
    color: #81b1db;
}

b,
th,
dt,
strong {
    color: #DEDEDE;
    /* variable */
}

mark {
    background: #D3D40E;
}

blockquote {
    color: #9DA2A6;
}

table a {
    color: #DEDEDE;
    /* variable */
}

th,
td {
    border: solid 1px #474d54;
    /* variable */
}

.task-list {
    padding-left: 0;
}

.md-task-list-item {
    padding-left: 1.25rem;
}

.md-task-list-item > input {
    top: auto;
}

.md-task-list-item > input:before {
    content: "";
    display: inline-block;
    width: 0.875rem;
    height: 0.875rem;
    vertical-align: middle;
    text-align: center;
    border: 1px solid #b8bfc6;
    background-color: #363B40;
    margin-top: -0.4rem;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before {
    content: '\221A';
    /*◘*/
    font-size: 0.625rem;
    line-height: 0.625rem;
    color: #DEDEDE;
}

/** quick open **/
.auto-suggest-container {
    border: 0px;
    background-color: #525C65;
}

#typora-quick-open {
    background-color: #525C65;
}

#typora-quick-open input{
    background-color: #525C65;
    border: 0;
    border-bottom: 1px solid grey;
}

.typora-quick-open-item {
    background-color: inherit;
    color: inherit;
}

.typora-quick-open-item.active,
.typora-quick-open-item:hover {
    background-color: #4D8BDB;
    color: white;
}

.typora-quick-open-item:hover {
    background-color: rgba(77, 139, 219, 0.8);
}

.typora-search-spinner > div {
  background-color: #fff;
}

#write pre.md-meta-block {
    border-bottom: 1px dashed #ccc;
    background: transparent;
    padding-bottom: 0.6em;
    line-height: 1.6em;
}

.btn,
.btn .btn-default {
    background: transparent;
    color: #b8bfc6;
}

.ty-table-edit {
    border-top: 1px solid gray;
    background-color: #363B40;
}

.popover-title {
    background: transparent;
}

.md-image>.md-meta {
    color: #BBBBBB;
    background: transparent;
}

.md-expand.md-image>.md-meta {
    color: #DDD;
}

#write>h3:before,
#write>h4:before,
#write>h5:before,
#write>h6:before {
    border: none;
    border-radius: 0px;
    color: #888;
    text-decoration: underline;
    left: -1.4rem;
    top: 0.2rem;
}

#write>h3.md-focus:before {
    top: 2px;
}

#write>h4.md-focus:before {
    top: 2px;
}

.md-toc-item {
    color: #A8C2DC;
}

#write div.md-toc-tooltip {
    background-color: #363B40;
}

.dropdown-menu .btn:hover,
.dropdown-menu .btn:focus,
.md-toc .btn:hover,
.md-toc .btn:focus {
    color: white;
    background: black;
}

#toc-dropmenu {
    background: rgba(50, 54, 59, 0.93);
    border: 1px solid rgba(253, 253, 253, 0.15);
}

#toc-dropmenu .divider {
    background-color: #9b9b9b;
}

.outline-expander:before {
    top: 2px;
}

#typora-sidebar {
    box-shadow: none;
    border-right: 1px dashed;
    border-right: none;
}

.sidebar-tabs {
    border-bottom:0;
}

#typora-sidebar:hover .outline-title-wrapper {
    border-left: 1px dashed;
}

.outline-title-wrapper .btn {
    color: inherit;
}

.outline-item:hover {
    border-color: #363B40;
    background-color: #363B40;
    color: white;
}

h1.md-focus .md-attr,
h2.md-focus .md-attr,
h3.md-focus .md-attr,
h4.md-focus .md-attr,
h5.md-focus .md-attr,
h6.md-focus .md-attr,
.md-header-span .md-attr {
    color: #8C8E92;
    display: inline;
}

.md-comment {
    color: #5a95e3;
    opacity: 0.8;
}

.md-inline-math svg {
    color: #b8bfc6;
}

#math-inline-preview .md-arrow:after {
    background: black;
}

.modal-content {
    background: var(--bg-color);
    border: 0;
}

.modal-title {
    font-size: 1.5em;
}

.modal-content input {
    background-color: rgba(26, 21, 21, 0.51);
    color: white;
}

.modal-content .input-group-addon {
    color: white;
}

.modal-backdrop {
    background-color: rgba(174, 174, 174, 0.7);
}

.modal-content .btn-primary {
    border-color: var(--primary-color);
}

.md-table-resize-popover {
    background-color: #333;
}

.form-inline .input-group .input-group-addon {
    color: white;
}

#md-searchpanel {
    border-bottom: 1px dashed grey;
}

/** UI for electron */

.context-menu,
#spell-check-panel,
#footer-word-count-info {
    background-color: #42464A;
}

.context-menu.dropdown-menu .divider,
.dropdown-menu .divider {
    background-color: #777777;
    opacity: 1;
}

footer {
    color: inherit;
}

@media (max-width: 1000px) {
    footer {
        border-top: none;
    }
    footer:hover {
        color: inherit;
    }
}

#file-info-file-path .file-info-field-value:hover {
    background-color: #555;
    color: #dedede;
}

.megamenu-content,
.megamenu-opened header {
    background: var(--bg-color);
}

.megamenu-menu-panel h2,
.megamenu-menu-panel h1,
.long-btn {
    color: inherit;
}

.megamenu-menu-panel input[type='text'] {
    background: inherit;
    border: 0;
    border-bottom: 1px solid;
}

#recent-file-panel-action-btn {
    background: inherit;
    border: 1px grey solid;
}

.megamenu-menu-panel .dropdown-menu > li > a {
    color: inherit;
    background-color: #2F353A;
    text-decoration: none;
}

.megamenu-menu-panel table td:nth-child(1) {
    color: inherit;
    font-weight: bold;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(1) {
    color: white;
}

.modal-footer .btn-default, 
.modal-footer .btn-primary,
.modal-footer .btn-default:not(:hover) {
    border: 1px solid;
    border-color: transparent;
}

.btn-primary {
    color: white;
}

.btn-default:hover, .btn-default:focus, .btn-default.focus, .btn-default:active, .btn-default.active, .open > .dropdown-toggle.btn-default {
    color: white;
    border: 1px solid #ddd;
    background-color: inherit;
}

.modal-header {
    border-bottom: 0;
}

.modal-footer {
    border-top: 0;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: transparent !important;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(2) {
    color: inherit;
}

.megamenu-menu-panel .btn {
    border: 1px solid #eee;
    background: transparent;
}

.mouse-hover .toolbar-icon.btn:hover,
#w-full.mouse-hover,
#w-pin.mouse-hover {
    background-color: inherit;
}

.typora-node::-webkit-scrollbar {
    width: 5px;
}

.typora-node::-webkit-scrollbar-thumb:vertical {
    background: rgba(250, 250, 250, 0.3);
}

.typora-node::-webkit-scrollbar-thumb:vertical:active {
    background: rgba(250, 250, 250, 0.5);
}

#w-unpin {
    background-color: #4182c4;
}

#top-titlebar, #top-titlebar * {
    color: var(--item-hover-text-color);
}

.typora-sourceview-on #toggle-sourceview-btn,
#footer-word-count:hover,
.ty-show-word-count #footer-word-count {
    background: #333333;
}

#toggle-sourceview-btn:hover {
    color: #eee;
    background: #333333;
}

/** focus mode */
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) * {
    color: #686868 !important;
}

.on-focus-mode .md-end-block:not(.md-focus) img,
.on-focus-mode .md-task-list-item:not(.md-focus-container)>input {
    opacity: #686868 !important;
}

.on-focus-mode li[cid]:not(.md-focus-container){
    color: #686868;
}

.on-focus-mode .md-fences.md-focus .CodeMirror-code>*:not(.CodeMirror-activeline) *,
.on-focus-mode .CodeMirror.cm-s-inner:not(.CodeMirror-focused) * {
    color: #686868 !important;
}

.on-focus-mode .md-focus,
.on-focus-mode .md-focus-container {
    color: #fff;
}

.on-focus-mode #typora-source .CodeMirror-code>*:not(.CodeMirror-activeline) * {
    color: #686868 !important;
}


/*diagrams*/
#write .md-focus .md-diagram-panel {
    border: 1px solid #ddd;
    margin-left: -1px;
    width: calc(100% + 2px);
}

/*diagrams*/
#write .md-focus.md-fences-with-lineno .md-diagram-panel {
    margin-left: auto;
}

.md-diagram-panel-error {
    color: #f1908e;
}

.active-tab-files #info-panel-tab-file,
.active-tab-files #info-panel-tab-file:hover,
.active-tab-outline #info-panel-tab-outline,
.active-tab-outline #info-panel-tab-outline:hover {
    color: #eee;
}

.sidebar-footer-item:hover,
.footer-item:hover {
    background: inherit;
    color: white;
}

.ty-side-sort-btn.active,
.ty-side-sort-btn:hover,
.selected-folder-menu-item a:after {
    color: white;
}

#sidebar-files-menu {
    border:solid 1px;
    box-shadow: 4px 4px 20px rgba(0, 0, 0, 0.79);
    background-color: var(--bg-color);
}

.file-list-item {
    border-bottom:none;
}

.file-list-item-summary {
    opacity: 1;
}

.file-list-item.active:first-child {
    border-top: none;
}

.file-node-background {
    height: 32px;
}

.file-library-node.active>.file-node-content,
.file-list-item.active {
    color: white;
    color: var(--active-file-text-color);
}

.file-library-node.active>.file-node-background{
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}
.file-list-item.active {
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}

#ty-tooltip {
    background-color: black;
    color: #eee;
}

.md-task-list-item>input {
    margin-left: -1.3em;
    margin-top: 0.3rem;
    -webkit-appearance: none;
}

.md-mathjax-midline {
    background-color: #57616b;
    border-bottom: none;
}

footer.ty-footer {
    border-color: #656565;
}

.ty-preferences .btn-default {
    background: transparent;
}
.ty-preferences .btn-default:hover {
    background: #57616b;
}

.ty-preferences select {
    border: 1px solid #989698;
    height: 21px;
}

.ty-preferences .nav-group-item.active,
.export-item.active,
.export-items-list-control,
.export-detail {
    background: var(--item-hover-bg-color);
}

.ty-preferences input[type="search"] {
    border-color: #333;
    background: #333;
    line-height: 22px;
    border-radius: 6px;
    color: white;
}

.ty-preferences input[type="search"]:focus {
    box-shadow: none;
}

[data-is-directory="true"] .file-node-content {
    margin-bottom: 0;
}

.file-node-title {
    line-height: 22px;
}

.html-for-mac .file-node-open-state, .html-for-mac .file-node-icon {
    line-height: 26px;
}

::-webkit-scrollbar-thumb {
    background: rgba(230, 230, 230, 0.30);
}

::-webkit-scrollbar-thumb:active {
    background: rgba(230, 230, 230, 0.50);
}

#typora-sidebar:hover div.sidebar-content-content::-webkit-scrollbar-thumb:horizontal {
    background: rgba(230, 230, 230, 0.30);
}

.nav-group-item:active {
    background-color: #474d54 !important;
}

.md-search-hit {
    background: rgba(199, 140, 60, 0.81);
    color: #eee;
}

.md-search-hit * {
    color: #eee;
}

#md-searchpanel input {
    color: white;
}

.modal-backdrop.in {
    opacity: 1;
    backdrop-filter: blur(1px);
}

.clear-btn-icon {
    top: 8px;
}


mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						}
</style><title>Dell(2025JEL)-zh-D</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><p><span>原文为</span><a href='https://pubs.aeaweb.org/doi/10.1257/jel.20241733'><span>Dell (2025 JEL)</span></a><span>，使用DeepSeek-V3.2翻译</span></p><h1 id='面向经济学家的深度学习-'><span>面向经济学家的深度学习</span><sup class='md-footnote'><a href='#dfref-footnote-1' name='ref-footnote-1'>1</a></sup></h1><p><span>Melissa Dell</span><sup class='md-footnote'><a href='#dfref-footnote-2' name='ref-footnote-2'>2</a></sup></p><p><span>深度学习提供了从大规模非结构化文本和图像数据集中推算结构化信息的强大方法。例如，经济学家可能希望检测卫星图像中经济活动的存在，或衡量社交媒体、国会记录或公司文件中提及的主题或实体。本综述介绍了深度神经网络，涵盖了分类器、回归模型、生成式人工智能 (AI) 和嵌入模型等方法。应用包括分类、文档数字化、记录链接以及在海量文本和图像语料库中进行数据探索的方法。当使用合适的方法时，深度学习模型的调优成本可能很低，并且能够经济地扩展到涉及数百万或数十亿数据点的问题。本综述附带一个定期更新的配套网站 EconDL (</span><a href='https://econdl.github.io/' target='_blank' class='url'>https://econdl.github.io/</a><span>)，提供用户友好的演示笔记本、软件资源和一个提供技术细节和额外应用的知识库。(JEL C38, C45, C88, D83)</span></p><p>&nbsp;</p><h2 id='1-引言'><span>1. 引言</span></h2><p><span>深度神经网络带来了许多近期的科学成就——从在崎岖的火星地形上着陆探测器，到创建功能强大的聊天机器人，再到改变疾病的诊断方式。深度神经网络通常将非结构化数据，如文本、文档图像扫描、卫星和其他图像、视频和音频，映射到一个连续的向量空间。换句话说，它们将复杂多样的数据类型映射成更易于处理和理解的格式。在上述例子中，生成的向量用于计算操控航天器的指令、根据提示自回归地预测下一个单词，或识别图像是否包含肿瘤。类似地，经济学家可能使用神经网络来检测街景图像中非正规商贩的存在，或衡量公司文件或政府文件中提及的主题或人物。</span></p><p><span>深度学习的核心是一种从经验示例中学习数据表示的方法 (LeCun, Bengio, and Hinton 2015)。这些表示将高维非结构化数据简化为连续向量。深度神经网络在多个抽象层次上学习表示，组合了每个非线性神经网络模块，这些模块使用学习到的权重将神经网络前一层的表示转换为稍微更抽象的表示（术语“深度”意指这些多层的转换）。这些权重通过最小化一个损失函数来估计，该函数将模型对某项任务的预测与真实示例进行比较。</span></p><p><span>为什么要使用神经网络将原始数据转换为这些向量表示，而不是直接处理原始文本或图像呢？首先，深度神经网络不仅仅从手头的问题中学习。相反，它们通过接触大规模数据，将相关信息融入其参数中。在现代语言模型或视觉模型的预训练期间，模型将接触数百万的文本或图像，学习语言或视觉的基本结构。在处理非结构化数据时，接触大量数据对于获得强大性能至关重要，因为人类的语言和视觉异常复杂。这一原理被称为迁移学习，是深度神经方法成功的关键。</span></p><p><span>此外，原始像素或单词缺乏上下文，而上下文是解释其含义所必需的。深度神经网络提供了一种计算上下文化表示的强大方法。它们将术语或像素映射到依赖于其他附近术语或像素的向量，其参数主要通过大规模预训练学习。</span></p><p><span>最后，原始文本和图像在计算上难以处理。相比之下，有极其优化的工具用于连续向量计算。例如，Silcock 等人 (2022) 在单个中端图形处理单元 (GPU) 上用了三小时完成精确的向量相似性计算。这意味着可以以前所未有的规模分析数据。理论用数据来检验，虽然更多的数据不能解决因果关系的挑战，但总体上它将为经济学家提供更细粒度的信息来检验各种假设。</span></p><p><span>本综述旨在弥合最先进的深度学习研究与经济应用之间的差距。它侧重于在真实情况无争议但由于问题规模巨大而需要自动化提取的背景下，从非结构化文本或图像中推算低维结构化数据。然后，这些结构化数据被用于因果或描述性分析，无论是作为结果、内生变量、工具变量还是控制变量。经济学家已经手动或通过传统方法执行的任务（例如，记录链接、文本分类、文档扫描数字化）可以更准确地进行大规模自动化，深度学习也促进了新颖数据的提取。与 Gentzkow, Kelly, and Taddy (2019) 的先前综述一样，本综述强调文本即数据，但采用了自该文章发表以来开发的方法。</span></p><p><span>本综述中的许多应用都属于分类的广泛范畴：将高维非结构化数据映射到离散类别。这些类别可以识别卫星图像中存在的物体类型或文档图像扫描中的数字和单词。或者，类别可以识别文本的主题、它们被复制的来源，或其中引用的独特个体或地点。语言模型可用于将原始文本编码为较低维的密集向量表示，一个用于全文，一个用于每个单独的术语（其中“密集”意味着向量在每个位置都有非零值）。研究人员可以通过向语言模型添加一个分类器层，使用这些向量表示来预测文本是否关于给定主题、引用了哪些地点等等。图像分类的工作原理类似。生成式 AI 模型也可以被提示来推算这些分类。或者，可以直接处理密集向量表示，这些表示被称为嵌入。</span></p><p><img src="fig/Dell2025JEL-fig1.png" referrerpolicy="no-referrer" alt="fig1"></p><p><span>图 1 提供了一个处理分类问题的流程图。要问的第一个问题是：“类别是事先枚举的吗？”有时，类别未知，或者研究人员可能希望在将模型应用于新设置时添加类别，而无需重新训练它。分类器使用语言或视觉模型的最后一层为每个类别计算一个分数。因此，只有当类别在训练中被指定并看到时，才能估计分类器。如果类别未指定，研究人员将需要直接处理嵌入。如果有很多类别，例如记录链接，其中每个唯一实体可以被视为一个类别，由于估计分类器的计算限制，研究人员将再次需要处理嵌入。</span></p><p><span>当类别事先指定且数量不多时，分类器或生成式 AI 都可能很适合该问题。如果应用偏离了用于预训练神经网络的数据——在处理历史数据、文档扫描或某些专门设置时很常见——则存在与预训练语料库的显著领域偏移，可能需要调优一个定制的分类器以实现强大的性能。类别定义的细微差别也很重要。对于简单的任务，使用现成的生成式 AI 模型（如 OpenAI 的生成式预训练 Transformer (generative pretraining transformer, GPT)）将分类框架为文本生成可能效果很好。对于更细微的任务，定制训练的分类器通过接触细粒度的示例可以更好地捕捉那种细微差别。如果有疑问，研究人员可以尝试现成的方法，如果性能不令人满意，则切换到定制的分类器。本综述表明，虽然在文本分类任务上，定制训练的分类器通常优于 GPT，但生成式 AI 和定制分类器在简单任务上都表现良好。本综述还考虑了这些方法的成本。</span></p><p><span>表 1 总结了本综述的应用。大多数可以框架为分类问题。文章还回顾了回归，其中使用神经网络从文本或图像中推算连续值。需要注意的是，“回归”这个术语在机器学习中的使用方式与经济学中略有不同，这可能会引起混淆。在机器学习中，“回归”指的是预测连续数字，而“分类”指的是预测离散结果。回归包括任何用于预测连续结果的模型类型；在本综述中，我们考虑使用深度神经网络的回归。</span></p><p><span>在深度学习时代之前，不同领域的问题以非常不同的方式处理，使用针对给定语言或特定类型图像等具体特征进行大量工程设计的规则；而深度学习具有显著的泛化能力。例如，自然语言处理 (NLP)、计算机视觉和音频处理都使用相同的最先进的神经网络架构。这种可泛化性在本综述讨论的多样化应用中显而易见。</span></p><p><span>各种神经网络应用超出了本综述的范围。它不涵盖如何更普遍地使用语言模型来提高经济学家的生产力，如 Korinek (2023) 所讨论的。它也不涵盖深度学习之外的机器学习方法，例如应用于结构化数据的方法（通常使用较浅的网络），如 Athey and Imbens (2019) 的综述所总结的。此外，它不研究使用深度神经网络来计算组合优化和高维动态随机一般均衡 (DSGE) 问题的近似解。近似这些解需要学习一个神经网络，将原始问题映射到一个保持问题本质属性的连续向量空间。这很有用，因为在这个空间中计算近似解比传统方法快得多，允许近似更大的问题。这与本综述涵盖的方法有许多相似之处，但应用差异很大，需要单独处理。读者可以参考 Fernández-Villaverde (2024) 和 Vitercik (2023) 的课程。最后，一小部分文献直接在因果框架中使用深度神经网络。例如，Lynn, Kummerfeld, and Mihalcea (2020) 使用分类器和实验来研究文本的变体如何因果地影响决策。虽然这在实验性操纵文本时有作用，但通常研究人员希望从高维非结构化数据中提取低维表示（例如，文本的主题、卫星图像中的物体、表格扫描中的数字、哪些文本记录指向同一家公司），并在因果估计方程中使用这些——而不是非结构化数据。因此，这里的重点是预测这些低维特征。本综述不试图总结这些预测如何在经济研究中使用，因为这一文献是新的且正在快速发展。</span></p><p><span>读者可能想知道本综述将多快过时。考虑一个流行的比喻是有帮助的：神经网络就像乐高积木：不同的神经网络组件可以以各种方式配置以实现不同的目的，或实现同一目的的更先进版本。本综述侧重于那些随着文献进展，可以轻松替换新神经网络组件的框架，例如，用视觉 Transformer (vision transformer, ViT) (Dosovitskiy et al. 2020) 替换旧的卷积神经网络，或用最新的语言模型更新基于 Transformer 的双向编码器表示 (BERT) 语言模型主干 (Devlin et al. 2019)。技术和实现细节——那些最可能随着文献进展而改变的部分——在配套的 EconDL 网站上提供：</span><a href='https://econdl.github.io/' target='_blank' class='url'>https://econdl.github.io/</a><span>。它提供了一个按核心主题组织的知识库，以及指向面向经济学家的开源软件包和使用深度学习构建大规模数据集的流程的链接。感兴趣的读者可以找到讲义以及指向博客文章、教科书处理、开放课件和原始论文的链接。EconDL 还链接到本综述中许多应用的演示笔记本。只要本综述涵盖的基于 Transformer 的方法保持最先进，并且一些软件包明确支持随着文献进展而替换新的神经网络，该网站将持续更新。</span></p><p><span>本文结构如下：第 2 节概述深度学习，第 3 节介绍基础架构。第 4 节讨论深度学习的数据要求，第 5 节考虑偏差和不确定性量化，第 6 节讨论可重用性和可重复性。接下来我们转向应用。第 7 介绍类别事先定义且类别数量不多的分类问题，比较分类器和生成式 AI。接着，第 8 节深入探讨嵌入模型，当类别数量庞大或类别事先未指定时，这些模型很有用。第 9 节考虑回归问题。还有其他方法来处理本综述涵盖的应用：第 10 节强调为什么所强调的方法最可能适合学术研究人员面临的约束。第 11 节总结。</span></p><h2 id='2-深度学习概述'><span>2. 深度学习概述</span></h2><h3 id='21-什么是深度学习'><span>2.1 什么是深度学习？</span></h3><p><span>深度神经网络学习原始数据的表示，这些表示提取对特定任务有用的信息。深度学习使用具有许多层的神经网络将原始数据映射到这些表示，将高维非结构化数据简化为连续向量。</span></p><p><span>为了对给定任务有意义地表示数据，神经网络一层中的节点（向量表示中的数字）通过与一个非线性函数结合而转换为下一层的节点，该函数的权重是学习到的参数。这些参数——数量从数百万到数十亿——通过最小化一个成本函数来估计，该函数将模型对某项任务（例如，预测文本中被掩码的术语）的预测与真实示例进行比较。对于那些不熟悉神经网络的人，我推荐 Sanderson (n.d.) 的入门视频。</span></p><p><span>新颖架构和方法的发展使得优化具有数百万到数十亿参数的神经网络变得可行。这些进展虽然很大程度上超出了这篇相对宽泛的综述的范围，但在 EconDL 知识库中有所讨论。特别是，在估计深度网络方面，许多开创性贡献出现在卷积神经网络的文献中，并在知识库的该帖子中进行了讨论。</span></p><p><span>从头开始训练深度神经网络需要大量数据，几个大规模数据集是文献的支柱：ImageNet——一个用于图像分类和相关任务的 1400 万图像数据集 (Deng et al. 2009)——和爬取语料库（例如，Cleaned Colossal Common Crawl (Raffel et al. 2020; Dodge et al. 2021)）——本质上是互联网快照的海量公共领域文本数据集。应用程序编程接口 (API) 背后的商业模型也可能许可专有训练数据。从头开始训练一个深度神经模型可能需要高达数百万美元的计算成本，但幸运的是，这很少是必要的。</span></p><p><span>深度学习改变了许多领域，这得益于迁移学习的力量：在一个领域训练的深度网络可以适应许多其他领域，所需的经验训练示例（通常几百到几千个）远少于从头开始训练模型所需的量。例如，需要训练主题分类器的研究人员可以访问 Hugging Face——NLP 的中心枢纽（第 4 节）——并下载由 Google、Meta 和 Microsoft 等实体公开提供的预训练最先进语言模型。该语言模型在一个巨大的语料库上训练，以预测从文本中随机掩码的词元（单词或子词）。通过这种训练，它学会了为文本生成有意义的上下文化向量表示。研究人员可以向预训练的语言模型添加一个分类器层，并使用相对适量的标注数据，在其分类任务上微调得到的神经网络。数百万模型参数中的大部分将保持不变，因为模型对语言的基本理解不需要更新，但与手头任务最相关的参数将更新以改进模型预测 (Merchant et al. 2020)。</span></p><p><span>近年来从深度学习中涌现的一个惊人发现是，即使对于非常大的模型（例如，数十亿参数），增加模型规模带来的收益仍能持续累积 (Raffel et al. 2020)。人类的视觉和语言是复杂的，需要一个丰富的表达性模型来捕捉这种复杂性。例如，假设我们希望执行一个简单的任务：分类图像中包含十个物体（马、汽车等）中的哪一个。分类器的输入是每个像素的 RGB 值 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="14.923ex" height="1.65ex" role="img" focusable="false" viewBox="0 -442 6596.1 729.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.65ex;"><defs><path id="MJX-53-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-53-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-53-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-53-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-53-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-53-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-53-TEX-I-1D465"></use></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-53-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(500,0)"><use data-c="2C" xlink:href="#MJX-53-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-53-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(1558.7,0)"><use data-c="2C" xlink:href="#MJX-53-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(2003.3,0)"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-53-TEX-I-1D465"></use></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-53-TEX-N-32"></use></g><g data-mml-node="mo" transform="translate(500,0)"><use data-c="2C" xlink:href="#MJX-53-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-53-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(3562,0)"><use data-c="2E" xlink:href="#MJX-53-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(4006.7,0)"><use data-c="2E" xlink:href="#MJX-53-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(4451.4,0)"><use data-c="2E" xlink:href="#MJX-53-TEX-N-2E"></use></g><g data-mml-node="msub" transform="translate(4896,0)"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-53-TEX-I-1D465"></use></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-53-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(600,0)"><use data-c="2C" xlink:href="#MJX-53-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(878,0)"><use data-c="1D45B" xlink:href="#MJX-53-TEX-I-1D45B"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>,</mo><mi>n</mi></mrow></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">x_{1,1}, x_{2,1} ... x_{n,n}</script><span>。假设我们使用这些输入估计一个线性分类器。每个类别 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="12.373ex" height="1.968ex" role="img" focusable="false" viewBox="0 -666 5468.9 870" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.462ex;"><defs><path id="MJX-54-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path id="MJX-54-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-54-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-54-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-54-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-54-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-54-TEX-I-1D457"></use></g><g data-mml-node="mo" transform="translate(689.8,0)"><use data-c="3D" xlink:href="#MJX-54-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(1745.6,0)"><use data-c="31" xlink:href="#MJX-54-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(2245.6,0)"><use data-c="2C" xlink:href="#MJX-54-TEX-N-2C"></use></g><g data-mml-node="mo" transform="translate(2690.2,0)"><use data-c="2E" xlink:href="#MJX-54-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(3134.9,0)"><use data-c="2E" xlink:href="#MJX-54-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(3579.6,0)"><use data-c="2E" xlink:href="#MJX-54-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(4024.2,0)"><use data-c="2C" xlink:href="#MJX-54-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(4468.9,0)"><use data-c="31" xlink:href="#MJX-54-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-54-TEX-N-30" transform="translate(500,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mn>10</mn></math></mjx-assistive-mml></mjx-container><script type="math/tex">j = 1,...,10</script><span> 的分数是 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="38.414ex" height="2.261ex" role="img" focusable="false" viewBox="0 -705 16979 999.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.666ex;"><defs><path id="MJX-55-TEX-I-1D6FD" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path><path id="MJX-55-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path id="MJX-55-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-55-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-55-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-55-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-55-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-55-TEX-N-22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path><path id="MJX-55-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-55-TEX-I-1D6FE" d="M31 249Q11 249 11 258Q11 275 26 304T66 365T129 418T206 441Q233 441 239 440Q287 429 318 386T371 255Q385 195 385 170Q385 166 386 166L398 193Q418 244 443 300T486 391T508 430Q510 431 524 431H537Q543 425 543 422Q543 418 522 378T463 251T391 71Q385 55 378 6T357 -100Q341 -165 330 -190T303 -216Q286 -216 286 -188Q286 -138 340 32L346 51L347 69Q348 79 348 100Q348 257 291 317Q251 355 196 355Q148 355 108 329T51 260Q49 251 47 251Q45 249 31 249Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D6FD" xlink:href="#MJX-55-TEX-I-1D6FD"></use></g><g data-mml-node="TeXAtom" transform="translate(599,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-55-TEX-I-1D457"></use></g><g data-mml-node="mo" transform="translate(412,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(690,0)"><use data-c="31" xlink:href="#MJX-55-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(1190,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(1468,0)"><use data-c="31" xlink:href="#MJX-55-TEX-N-31"></use></g></g></g><g data-mml-node="msub" transform="translate(2040.6,0)"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-55-TEX-I-1D465"></use></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-55-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(500,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-55-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(3821.5,0)"><use data-c="2B" xlink:href="#MJX-55-TEX-N-2B"></use></g><g data-mml-node="msub" transform="translate(4821.7,0)"><g data-mml-node="mi"><use data-c="1D6FD" xlink:href="#MJX-55-TEX-I-1D6FD"></use></g><g data-mml-node="TeXAtom" transform="translate(599,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-55-TEX-I-1D457"></use></g><g data-mml-node="mo" transform="translate(412,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(690,0)"><use data-c="31" xlink:href="#MJX-55-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(1190,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(1468,0)"><use data-c="32" xlink:href="#MJX-55-TEX-N-32"></use></g></g></g><g data-mml-node="msub" transform="translate(6862.3,0)"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-55-TEX-I-1D465"></use></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-55-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(500,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="32" xlink:href="#MJX-55-TEX-N-32"></use></g></g></g><g data-mml-node="mo" transform="translate(8587.6,0)"><use data-c="22EF" xlink:href="#MJX-55-TEX-N-22EF"></use></g><g data-mml-node="mo" transform="translate(9981.9,0)"><use data-c="2B" xlink:href="#MJX-55-TEX-N-2B"></use></g><g data-mml-node="msub" transform="translate(10982.1,0)"><g data-mml-node="mi"><use data-c="1D6FD" xlink:href="#MJX-55-TEX-I-1D6FD"></use></g><g data-mml-node="TeXAtom" transform="translate(599,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-55-TEX-I-1D457"></use></g><g data-mml-node="mo" transform="translate(412,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(690,0)"><use data-c="1D45B" xlink:href="#MJX-55-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(1290,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1568,0)"><use data-c="1D45B" xlink:href="#MJX-55-TEX-I-1D45B"></use></g></g></g><g data-mml-node="msub" transform="translate(13164.1,0)"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-55-TEX-I-1D465"></use></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-55-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(600,0)"><use data-c="2C" xlink:href="#MJX-55-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(878,0)"><use data-c="1D45B" xlink:href="#MJX-55-TEX-I-1D45B"></use></g></g></g><g data-mml-node="mo" transform="translate(15086.4,0)"><use data-c="2B" xlink:href="#MJX-55-TEX-N-2B"></use></g><g data-mml-node="msub" transform="translate(16086.6,0)"><g data-mml-node="mi"><use data-c="1D6FE" xlink:href="#MJX-55-TEX-I-1D6FE"></use></g><g data-mml-node="mi" transform="translate(551,-150) scale(0.707)"><use data-c="1D457" xlink:href="#MJX-55-TEX-I-1D457"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mrow data-mjx-texclass="ORD"><mi>j</mi><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow data-mjx-texclass="ORD"><mi>j</mi><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⋯</mo><mo>+</mo><msub><mi>β</mi><mrow data-mjx-texclass="ORD"><mi>j</mi><mo>,</mo><mi>n</mi><mo>,</mo><mi>n</mi></mrow></msub><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>,</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>γ</mi><mi>j</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\beta_{j,1,1} x_{1,1} + \beta_{j,1,2} x_{1,2} \cdots + \beta_{j,n,n} x_{n,n} + \gamma_j</script><span>，其中 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.127ex" height="2.261ex" role="img" focusable="false" viewBox="0 -705 940.3 999.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.666ex;"><defs><path id="MJX-56-TEX-I-1D6FD" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path><path id="MJX-56-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D6FD" xlink:href="#MJX-56-TEX-I-1D6FD"></use></g><g data-mml-node="mi" transform="translate(599,-150) scale(0.707)"><use data-c="1D457" xlink:href="#MJX-56-TEX-I-1D457"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mi>j</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\beta_j</script><span> 和 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.019ex" height="1.663ex" role="img" focusable="false" viewBox="0 -441 892.3 735.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.666ex;"><defs><path id="MJX-57-TEX-I-1D6FE" d="M31 249Q11 249 11 258Q11 275 26 304T66 365T129 418T206 441Q233 441 239 440Q287 429 318 386T371 255Q385 195 385 170Q385 166 386 166L398 193Q418 244 443 300T486 391T508 430Q510 431 524 431H537Q543 425 543 422Q543 418 522 378T463 251T391 71Q385 55 378 6T357 -100Q341 -165 330 -190T303 -216Q286 -216 286 -188Q286 -138 340 32L346 51L347 69Q348 79 348 100Q348 257 291 317Q251 355 196 355Q148 355 108 329T51 260Q49 251 47 251Q45 249 31 249Z"></path><path id="MJX-57-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D6FE" xlink:href="#MJX-57-TEX-I-1D6FE"></use></g><g data-mml-node="mi" transform="translate(551,-150) scale(0.707)"><use data-c="1D457" xlink:href="#MJX-57-TEX-I-1D457"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mi>j</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\gamma_j</script><span> 是估计的参数。分类器预测分配给分数最高的类别。一个类别的权重参数在该类物体倾向于出现的像素处会更大。这本质上是脆弱的，因为对于每个类别，每个像素只有一个参数，但一匹马可能在其姿态、大小、在图像中的位置、颜色或体格等方面变化。在 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.383ex" height="2.034ex" role="img" focusable="false" viewBox="0 -705 2379.3 899" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-58-TEX-I-1D6FD" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path><path id="MJX-58-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJX-58-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-58-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-58-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-58-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D6FD" xlink:href="#MJX-58-TEX-I-1D6FD"></use></g><g data-mml-node="TeXAtom" transform="translate(599,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="210E" xlink:href="#MJX-58-TEX-I-210E"></use></g><g data-mml-node="mi" transform="translate(576,0)"><use data-c="1D45C" xlink:href="#MJX-58-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(1061,0)"><use data-c="1D45F" xlink:href="#MJX-58-TEX-I-1D45F"></use></g><g data-mml-node="mi" transform="translate(1512,0)"><use data-c="1D460" xlink:href="#MJX-58-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(1981,0)"><use data-c="1D452" xlink:href="#MJX-58-TEX-I-1D452"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mrow data-mjx-texclass="ORD"><mi>h</mi><mi>o</mi><mi>r</mi><mi>s</mi><mi>e</mi></mrow></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\beta_{horse}</script><span> 的图中，人们可能会看到一匹马站在图像中央，有两个头朝向不同方向，因为线性分类器努力为经验上马可能出现的位置的像素分配高值。一个大型神经网络在预测图像中是否有马时，有效地允许了许多这样的“过滤器”。</span></p><p><span>或者，假设我们想分析陈述（例如，在调查数据中）具有积极、消极还是中性情感。经济学文献中常用的传统方法是词袋法。研究人员在查找表中查找每个单词的情感，并将这些聚合起来以衡量句子的情感（图 2）。</span></p><p><img src="fig/Dell2025JEL-fig2.png" referrerpolicy="no-referrer" alt="fig2"></p><p><span>很容易看出这种方法的局限性。考虑以下句子：“我喜欢这篇文章”，“我不喜欢这篇文章”，“我不讨厌这篇文章”，“关于这篇文章，没有我不喜欢的地方”。人们无法通过将每个单词的独立表示相加来捕捉这些不同的情感——即使在这些非常简单的句子中也是如此。相反，我们需要对单词的非线性组合进行建模，而神经网络是近似复杂非线性函数的最先进工具。</span></p><p><span>当使用现代语言模型处理文本时（图 2 底部面板），分词器首先将输入中的每个单词映射到由查找字典分配的数字。（如果单词不在字典中，它会被拆分成在字典中的子词。）这些数字使用学习到的参数转换为向量，然后通过神经网络传递，神经网络在每一层逐步将它们转换为输入词元的语义丰富的表示。视觉模型大致类似，将像素或图像块作为输入。</span></p><p><span>神经网络的主要替代方法是使用人工设计的特征。换句话说，研究人员预先指定处理原始信息的规则。例如，表格数字化可以通过编写规则来检测分隔行和列的连接空白区域来实现。而使用深度学习，模型则被展示带注释的表格布局示例。深度学习革命一遍又一遍地表明——跨越许多不同的任务——从经验示例中学习在处理非结构化数据方面大大优于人工设计的特征提取。其中一些证据在 EconDL 知识库中讨论。</span></p><p><span>在许多经济应用中，深度学习也可能优于特征工程。经济学家希望处理的信息通常是复杂且有噪声的。例如，文档扫描会因老化、扫描和历史印刷技术而引入噪声；或者，文本数据可能包含光学字符识别 (OCR) 错误或拼写错误。人类语言是复杂的，表达相同情感的方式多种多样，单词的含义可能因上下文而有显著变化。噪声和复杂性为人工设计的规则创造了例外，这些例外也必须硬编码，同样还有例外的例外。最初看似简单的任务，随着研究人员试图硬编码这些例外，可能很快变得错综复杂。即使结果令人满意，人工设计的系统很可能高度针对手头的案例，并且不能很好地转化到具有不同类型复杂性和噪声的其他数据。</span></p><p><span>深度学习的另一个潜在优势是，训练和实现神经网络的配方是标准且可重复的，而人工设计的特征提取则固有地存在显著的自由裁量权。即使不考虑研究人员的自由度，设计规则也需要大量的领域知识。例如，在统计机器翻译中，大量研究人员花了数十年时间设计复杂的统计规则用于机器翻译。这些系统被少数研究人员在几个月内开发的神经网络超越。神经翻译的后续进展催生了 Transformer 架构 (Vaswani et al. 2017)，此后它彻底改变了自然语言处理、计算机视觉、音频和其他领域。</span></p><h2 id='3-基础深度学习架构'><span>3. 基础深度学习架构</span></h2><p><span>本节简要介绍神经网络架构。对于不熟悉的读者，我建议查阅 EconDL 知识库及其中的资源以获取更详细的处理。</span></p><h3 id='31-神经网络基础'><span>3.1 神经网络基础</span></h3><p><span>神经网络由相互连接的节点层组成，这些节点称为神经元。每个神经元持有一个值。神经元的值通过使用激活函数和学习到的权重组合前一层神经元的值来计算。这些多层将输入（例如，分词后的文本）转换为对执行期望任务有用的向量。</span></p><p><span>一个激活函数的例子是整流线性单元 (ReLU)：</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="17.22ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 7611.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-59-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-59-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-59-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-59-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-59-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-59-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-59-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-59-TEX-N-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path><path id="MJX-59-TEX-N-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path id="MJX-59-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-59-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-59-TEX-N-7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D453" xlink:href="#MJX-59-TEX-I-1D453"></use></g><g data-mml-node="mo" transform="translate(550,0)"><use data-c="28" xlink:href="#MJX-59-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(939,0)"><use data-c="1D465" xlink:href="#MJX-59-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(1511,0)"><use data-c="29" xlink:href="#MJX-59-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(2177.8,0)"><use data-c="3D" xlink:href="#MJX-59-TEX-N-3D"></use></g><g data-mml-node="mo" transform="translate(3233.6,0)"><use data-c="6D" xlink:href="#MJX-59-TEX-N-6D"></use><use data-c="61" xlink:href="#MJX-59-TEX-N-61" transform="translate(833,0)"></use><use data-c="78" xlink:href="#MJX-59-TEX-N-78" transform="translate(1333,0)"></use></g><g data-mml-node="mo" transform="translate(5094.6,0)"><use data-c="7B" xlink:href="#MJX-59-TEX-N-7B"></use></g><g data-mml-node="mn" transform="translate(5594.6,0)"><use data-c="30" xlink:href="#MJX-59-TEX-N-30"></use></g><g data-mml-node="mo" transform="translate(6094.6,0)"><use data-c="2C" xlink:href="#MJX-59-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(6539.2,0)"><use data-c="1D465" xlink:href="#MJX-59-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(7111.2,0)"><use data-c="7D" xlink:href="#MJX-59-TEX-N-7D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mi>x</mi><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">f(x) = \max\{0, x\}</script><span>，其中</span>
<mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="36.331ex" height="2.009ex" role="img" focusable="false" viewBox="0 -694 16058.5 888" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-60-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-60-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-60-TEX-I-1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path><path id="MJX-60-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-60-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path><path id="MJX-60-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-60-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-60-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-60-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-60-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-60-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-60-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-60-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(849.8,0)"><use data-c="3D" xlink:href="#MJX-60-TEX-N-3D"></use></g><g data-mml-node="msub" transform="translate(1905.6,0)"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-60-TEX-I-1D464"></use></g><g data-mml-node="mn" transform="translate(749,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-60-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(3280.3,0)"><use data-c="22C5" xlink:href="#MJX-60-TEX-N-22C5"></use></g><g data-mml-node="msub" transform="translate(3780.6,0)"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-60-TEX-I-1D456"></use></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-60-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(4784.3,0)"><use data-c="2B" xlink:href="#MJX-60-TEX-N-2B"></use></g><g data-mml-node="msub" transform="translate(5784.6,0)"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-60-TEX-I-1D464"></use></g><g data-mml-node="mn" transform="translate(749,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-60-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(7159.3,0)"><use data-c="22C5" xlink:href="#MJX-60-TEX-N-22C5"></use></g><g data-mml-node="msub" transform="translate(7659.5,0)"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-60-TEX-I-1D456"></use></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-60-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(8441.1,0)"><use data-c="2B" xlink:href="#MJX-60-TEX-N-2B"></use></g><g data-mml-node="mo" transform="translate(9219.1,0)"><use data-c="2E" xlink:href="#MJX-60-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(9663.8,0)"><use data-c="2E" xlink:href="#MJX-60-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(10108.4,0)"><use data-c="2E" xlink:href="#MJX-60-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(10553.1,0)"><use data-c="2B" xlink:href="#MJX-60-TEX-N-2B"></use></g><g data-mml-node="msub" transform="translate(11331.1,0)"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-60-TEX-I-1D464"></use></g><g data-mml-node="mi" transform="translate(749,-150) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-60-TEX-I-1D45B"></use></g></g><g data-mml-node="mo" transform="translate(12776.6,0)"><use data-c="22C5" xlink:href="#MJX-60-TEX-N-22C5"></use></g><g data-mml-node="msub" transform="translate(13276.8,0)"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-60-TEX-I-1D456"></use></g><g data-mml-node="mi" transform="translate(378,-150) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-60-TEX-I-1D45B"></use></g></g><g data-mml-node="mo" transform="translate(14351.3,0)"><use data-c="2B" xlink:href="#MJX-60-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(15351.5,0)"><use data-c="1D44F" xlink:href="#MJX-60-TEX-I-1D44F"></use></g><g data-mml-node="mo" transform="translate(15780.5,0)"><use data-c="2C" xlink:href="#MJX-60-TEX-N-2C"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>i</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>i</mi><mn>2</mn></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>w</mi><mi>n</mi></msub><mo>⋅</mo><msub><mi>i</mi><mi>n</mi></msub><mo>+</mo><mi>b</mi><mo>,</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex"> x = w_1 \cdot i_1 + w_2 \cdot i_2 + ... + w_n \cdot i_n + b, </script>
<mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="14.019ex" height="1.441ex" role="img" focusable="false" viewBox="0 -443 6196.4 637" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-61-TEX-I-1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path><path id="MJX-61-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-61-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-61-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-61-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-61-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-61-TEX-I-1D464"></use></g><g data-mml-node="mn" transform="translate(749,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-61-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(1152.6,0)"><use data-c="2C" xlink:href="#MJX-61-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(1597.2,0)"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-61-TEX-I-1D464"></use></g><g data-mml-node="mn" transform="translate(749,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-61-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(2749.8,0)"><use data-c="2C" xlink:href="#MJX-61-TEX-N-2C"></use></g><g data-mml-node="mo" transform="translate(3194.4,0)"><use data-c="2E" xlink:href="#MJX-61-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(3639.1,0)"><use data-c="2E" xlink:href="#MJX-61-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(4083.8,0)"><use data-c="2E" xlink:href="#MJX-61-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(4528.4,0)"><use data-c="2C" xlink:href="#MJX-61-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(4973.1,0)"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-61-TEX-I-1D464"></use></g><g data-mml-node="mi" transform="translate(749,-150) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-61-TEX-I-1D45B"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>w</mi><mi>n</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">w_1, w_2, ..., w_n</script><span> 和 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.971ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 429 705" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-101-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D44F" xlink:href="#MJX-101-TEX-I-1D44F"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">b</script><span> 是学习到的权重和偏置项，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="11.501ex" height="1.934ex" role="img" focusable="false" viewBox="0 -661 5083.4 855" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-63-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-63-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-63-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-63-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-63-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-63-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-63-TEX-I-1D456"></use></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-63-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(781.6,0)"><use data-c="2C" xlink:href="#MJX-63-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(1226.2,0)"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-63-TEX-I-1D456"></use></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-63-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(2007.8,0)"><use data-c="2C" xlink:href="#MJX-63-TEX-N-2C"></use></g><g data-mml-node="mo" transform="translate(2452.4,0)"><use data-c="2E" xlink:href="#MJX-63-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(2897.1,0)"><use data-c="2E" xlink:href="#MJX-63-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(3341.8,0)"><use data-c="2E" xlink:href="#MJX-63-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(3786.4,0)"><use data-c="2C" xlink:href="#MJX-63-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(4231.1,0)"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-63-TEX-I-1D456"></use></g><g data-mml-node="mi" transform="translate(378,-150) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-63-TEX-I-1D45B"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>i</mi><mn>1</mn></msub><mo>,</mo><msub><mi>i</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>i</mi><mi>n</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">i_1, i_2, ..., i_n</script><span> 是来自网络前一层神经元的输入值。当我们将数据输入神经网络时，输入值在每一层被激活函数转换。最后一层的节点是输出。</span></p><p><span>激活函数是神经网络的重要组成部分，因为它们引入了非线性，使网络能够捕捉数据中的非线性关系。知识库中的“卷积神经网络”帖子进一步介绍了激活函数。</span></p><p><span>为了优化神经网络，使用损失函数将输出与真实标签进行比较。这些标签衡量什么取决于目标：例如，预测语言模型中被掩码的术语或预测图像模型的图像类别。与任何优化问题一样，我们需要知道损失相对于每个权重的梯度以最小化函数。对于从输出层开始并向后移动到输入层的每一层，我们计算损失相对于该层权重的梯度。这需要使用链式法则。链式法则允许我们通过逐层相乘计算出的导数来计算损失相对于网络中任何权重的导数。这被称为反向传播。权重使用梯度下降算法进行调整。</span></p><p><span>鼓励不熟悉反向传播的读者查阅 Sanderson (n.d.) 获取高质量、图形化的介绍。希望获得更深入理解的读者可能会喜欢 Karpathy (2022)，这是一个高级反向传播教程。Nielsen (2015) 为那些先前不熟悉神经网络的人提供了教科书式的处理。Goodfellow, Bengio, and Courville (2016) 为那些已经熟悉并希望深入回顾的人提供了教科书式的处理，而 Stevens, Antiga, and Viehmann (2020) 的论文则针对那些希望通过 PyTorch 中的动手实现来学习关键概念的人。</span></p><p><span>在普通的全连接前馈神经网络中，一层的所有神经元都连接到下一层的所有神经元。深度全连接网络在实践中很少使用。相反，少数几种类型的神经网络主导了深度学习文献。本综述侧重于卷积神经网络 (CNNs；第 3.2 节)、循环神经网络 (RNNs；第 3.3 节) 和 Transformer（第 3.4、3.5 和 3.6 节）。</span></p><h3 id='32-卷积神经网络'><span>3.2 卷积神经网络</span></h3><p><span>CNNs 利用图像中存在的空间结构，在引领深度学习革命中发挥了核心作用。尽管出现了用于图像处理的更新架构——视觉 Transformer (vision transformer, ViT)（第 3.6 节）——它们仍然被广泛使用，当适当现代化时可以获得近乎最先进的性能，并且可以比视觉 Transformer 更轻量且更容易调优。本节简要介绍。我建议不熟悉 CNNs 的读者查阅 Sanderson (2020) 关于卷积的简短图形介绍，因为对下述概念的视觉介绍特别有帮助。其他资源在 EconDL 知识库的“卷积神经网络”页面上。</span></p><p><span>视觉问题始于给定高度（像素）、宽度（像素）和深度（例如，RGB 图像为 3）的图像。卷积层是 CNN 的核心构建块。这些层的参数由一组可学习的过滤器组成，例如，3 × 3、5 × 5 或 7 × 7 权重矩阵。在计算下一层的输出时，这些过滤器仅应用于给定节点周围的节点，并且贯穿输入的整个深度。每个过滤器在输入上进行卷积（移动），在每个空间位置产生一个激活。与全连接层相比，在不同空间位置使用相同的权重极大地减少了参数数量。此外，参数共享确保无论特征在图像中的位置如何，都能被检测到。这赋予了 CNNs 一定程度的平移不变性，这是可取的，因为例如，无论马在图像中的位置如何，马就是马。</span></p><p><span>小卷积过滤器固有的局部性偏差是合乎逻辑的，因为像素的解释受其邻近像素的影响大于受远处像素的影响。尽管这些过滤器具有局部性，但 CNN 仍通过网络的深度实现了广泛的感受野。CNNs 擅长学习层次化特征：具有更有限感受野的较低层捕捉简单模式（如边缘），而更深层捕捉越来越复杂的结构。</span></p><p><span>除了卷积层，CNNs 还使用池化层。如果将 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.378ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 1051 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-94-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-94-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">M</script><span> 个不同的卷积过滤器应用于神经网络层，则下一层的深度将为 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.378ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 1051 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-94-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-94-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">M</script><span>，因为每个过滤器在每个空间位置产生一个激活。池化层减少了这种深度，防止参数数量变得不可行。通常，CNN 由交替的卷积层和池化层组成。</span></p><p><span>估计具有许多层的神经网络的核心挑战是梯度消失问题 (Bengio, Simard, and Frasconi 1994)。反向传播计算成本函数相对于网络中每个权重的梯度。这需要应用链式法则来找到损失相对于每层输出的梯度，然后找到每层输出相对于其输入的梯度。对于输入的极端值，导数可能变得非常小。反向传播将小梯度相乘。因此，梯度在流回较早层时可能呈指数级变小。如果初始层的梯度变得极小，学习将非常缓慢或完全停止。EconDL 上关于“卷积神经网络”的帖子探讨了 CNN 架构的演变，包括允许优化更深、更具表达性的网络的关键创新，从而规避了梯度消失问题 (Krizhevsky, Sutskever, and Hinton 2012; Simonyan and Zisserman 2014; Szegedy et al. 2015; He et al. 2016; Xie et al. 2017; Howard et al. 2019; Liu et al. 2022)。</span></p><h3 id='33-循环神经网络'><span>3.3 循环神经网络</span></h3><p><span>CNNs 需要固定大小的输入，因为神经网络是用固定维度的权重矩阵初始化的（可变大小的图像需要调整大小或填充）。相比之下，循环神经网络 (RNNs) 旨在处理可变大小的输入和输出。它们历史上在 NLP 中扮演了重要角色 (Hochreiter and Schmidhuber 1997; Greff et al. 2016)，尽管后来被 Transformer 取代。虽然研究人员通常应使用 Transformer 进行 NLP 应用，但我介绍 RNNs 作为与 Transformer 的比较点。</span></p><p><span>RNNs 迭代地处理一系列输入——例如，文本中的词元。在每个时间步，它们维护一个状态，该状态捕获关于输入序列的历史信息。随着网络处理序列中的每个元素，该状态被迭代更新，允许网络“记住”可变长度输入中的先前元素。</span></p><p><span>长程依赖对人类语言很重要。引用 Vaswani 等人 (2017) 的一个突出例子：“动物没有过马路，因为它太累了”与“动物没有过马路，因为它太宽了”。“它”指的是动物还是马路？这根据“它”与输入中其他词元之间的依赖关系而变化。最突出的 RNN 是双向长短期记忆网络 (bidirectional long short-term memory, LSTM) (Hochreiter and Schmidhuber 1997)。双向性通过向前和向后馈送输入序列来捕捉两个方向的依赖关系。读者可以在 EconDL 知识库中找到关于 LSTMs 的更详细介绍。</span></p><h3 id='34-transformer'><span>3.4 Transformer</span></h3><p><span>Transformer (Vaswani et al. 2017) 彻底改变了 NLP，并几乎在所有深度学习领域取得进展，包括视觉、音频、图和强化学习。对于不熟悉的读者，我推荐 Alammar (2018b) 的“图解 Transformer”博客文章，被广泛认为是最易理解的介绍。Rush (2018) 对原始论文的注释也是一个经典参考。</span></p><p><span>最初的 Transformer 是一个神经翻译模型，其关键成分是注意力。序列中的所有词元（单词或子词）并行馈入模型，模型关注上下文中的所有其他词元，为每个词元创建上下文化表示。上下文化表示与传统的静态词表示 (Mikolov et al. 2013; Pennington, Socher, and Manning 2014; Olah 2014) 形成对比，在静态表示中，训练语料库中的给定单词总是具有相同的表示。Transformer 解决了 RNNs 的局部性偏差——当隐藏状态传递给每个顺序词元时信息会丢失——因为它可以关注序列中的任何词元，无论远近。</span></p><p><span>自注意力是二次方的，这限制了可以一次传入模型的文本长度（上下文窗口）。开源模型中典型的上下文窗口长度是 512 个词元。对于许多问题，这足够了（例如，文本可以分块，或者前 512 个词元足以形成有意义的文档表示）。也有具有稀疏注意力机制的模型，允许长上下文窗口。</span></p><p><span>输入并行馈入 Transformer，而不是像 RNN 中那样顺序馈入，允许训练充分利用 GPU 的并行计算能力。这使得在更多数据上训练更大的模型在计算上变得可行，所有这些都提高了性能 (Raffel et al. 2020)。</span></p><h3 id='35-transformer-大语言模型'><span>3.5 Transformer 大语言模型</span></h3><p><span>大多数现代 NLP 应用使用基于 Transformer 的大语言模型 (LLMs)。对于那些不熟悉 LLMs 或需要复习的人，我强烈推荐 Jay Alammar 的“图解 GPT-2/3” (Alammar 2019, 2020) 和“图解 BERT” (Alammar 2018a) 博客文章，它们提供了对 Transformer LLM 架构的直观图形介绍。</span></p><p><span>有两种主要类型的 Transformer LLMs。生成式（解码器）模型预测序列中的下一个单词 (Radford et al. 2019; Brown et al. 2020)。它们通常用于文本生成。由于它们通过预测下一个单词来训练，因此在为给定词元创建上下文化表示时只能关注先前的词元。这被称为因果注意力。</span></p><p><span>相比之下，掩码（编码器）语言模型是双向的：在创建序列中单词的上下文化表示时，它们可以关注序列中的所有单词（掩码注意力）。模型通过预测被掩码的词元来训练 (Devlin et al. 2019; Liu et al. 2019; Sanh et al. 2019a; Lan et al. 2019; He et al. 2020)。编码器模型通常在研究人员旨在创建文本表示时使用，这需要将整个文本馈入模型。双向性对此类任务很有帮助，因为单词前后的上下文对于创建其有语义意义的表示很有用。语言模型也可以结合编码器和解码器 Transformer 块，例如，如 Raffel 等人 (2020) 所示。</span></p><p><span>借助 Transformer 架构，同一个预训练语言模型可以用作各种任务的“主干”，促进迁移学习。这在图 3 中有所说明，该图改编自原始 BERT 论文中的插图 (Devlin et al. 2019)。一个 Transformer 语言模型为其输入中的每个词元（单词或子词）产生一个向量表示，以及一个代表整个输入文本的 </span><code>&lt;cls&gt;</code><span> 表示。第一个面板显示，可以通过向 </span><code>&lt;cls&gt;</code><span> 词元添加一个分类器头来对全文序列进行分类。分类器是一个前馈神经网络，它使用学习到的权重将最终 Transformer 层的 </span><code>&lt;cls&gt;</code><span> 向量中的节点聚合成每个类别的分数。或者，两个文本可以联合嵌入——由特殊词元 </span><code>&lt;sep&gt;</code><span> 分隔——然后可以向 </span><code>&lt;cls&gt;</code><span> 词元添加一个分类器来分类文本之间的关系（面板 B）。或者，可以通过向每个词元嵌入添加分类器头来对每个单独的术语进行分类（例如，标记它是否指代个人、地点等）（面板 C）。也可以识别文本片段（例如，问题的答案；面板 D）。</span></p><p><span>EconDL 知识库中关于“Transformer 语言模型”的帖子详细介绍了各种不同的 Transformer 预训练语言模型。</span></p><h3 id='36-视觉和音频-transformer'><span>3.6 视觉和音频 Transformer</span></h3><p><span>Transformer 彻底改变了深度学习的许多其他领域，包括计算机视觉 (Dosovitskiy et al. 2020; Touvron et al. 2021; Grill et al. 2020; Caron et al. 2021; Ali et al. 2021; He et al. 2022; Chen, Xie, and He 2021)。视觉 Transformer (ViTs) 使用与 Transformer 语言模型相同的 Transformer 架构，并进行了一些调整以使其适用于图像。与 NLP 中 Transformer 语言模型大大超越先前技术不同，在视觉领域，Transformer 相对于 CNNs 的收益更为有限 (Liu et al. 2022)。适当现代化的 CNN 通常与类似大小的 ViT 具有竞争力。此外，目前最小的 CNNs（例如，Howard 等人 2019）比轻量级 ViTs（例如，Mehta and Rastegari 2021）更小，并且在简单任务上也能表现良好。实际上，我建议从轻量级 CNN 开始——训练和部署将更容易且成本显著更低——如果轻量级模型不足，再检查更大的 CNN 或 ViT 模型的性能。EconDL 上关于视觉 Transformer 的帖子提供了更多关于 ViT 架构的细节。</span></p><p><span>Transformer 能够处理高度多样化类型的非结构化数据的程度，在其应用于音频时得到了惊人的展示。通过将 ViT 应用于音频的频谱图图像，实现了最先进的性能 (Gong, Chung, and Glass 2021)。更令人惊讶的是，通过在 ImageNet 上预训练——这是由超过 1400 万张自然图像（例如，狗、食物等）组成的主要视觉基准——性能达到了最大化，这是跨模态迁移学习的有力例证。</span></p><h3 id='37-优化神经网络'><span>3.7 优化神经网络</span></h3><p><span>能够优化神经网络显然是将其用于研究的核心。优化器（参见，例如，Kingma and Ba 2014; Goh 2017）、初始化 (He et al. 2015) 和归一化 (Ioffe and Szegedy 2015; Santurkar et al. 2018) 都很重要。为了估计深度神经模型，研究人员还必须选择各种超参数（例如，Li et al. 2017; Falkner, Klein, and Hutter 2018）。感兴趣的读者可以参考 EconDL 配套知识库中关于“训练和优化神经网络”的帖子。EconDL 上的软件包为各种超参数选择合理的默认值，旨在使训练神经网络更加用户友好。</span></p><p><span>虽然涉及各种细节，但我从指导许多学生优化神经网络中获得的主要实践心得是，当性能意外不佳时，最常见的原因要么是学习率选择不当，要么是输入数据格式不正确。学习率决定了优化器在训练期间调整权重时采取的步长大小。如果学习率太低，模型不会更新；如果太高，模型权重会剧烈振荡。此外，数据需要以特定格式提供，并且可能动态执行转换（例如，许多神经网络需要固定大小的输入）。神经网络从经验示例中学习，意外的不良性能通常是馈入格式错误的示例的结果。</span></p><p><span>我还建议深度学习新手使用专门为此目的设计的云服务器来训练和部署模型。EconDL 教程使用 Google Colab。在本地安装深度学习软件包需要解决大量的依赖关系，这对于经验有限的人来说可能具有挑战性。对于在研究中使用深度学习经验丰富的用户，购买自己的 GPU 通常可以节省大量成本。</span></p><h2 id='4-训练数据'><span>4. 训练数据</span></h2><p><span>高质量的训练和评估数据对于深度学习的实用性至关重要。在监督学习中，数据被划分为标注集和未标注集。未标注集由深度学习模型将应用于的所有数据组成，通常比标注集大得多。当相关标签自动从数据本身收集时，深度学习是自监督的。例如，语言模型可以通过预测从海量文本语料库中随机掩码的单词来进行预训练。类似地，可以对图像应用掩码策略以进行视觉模型的自监督预训练 (He et al. 2022)。自监督学习最常用于预训练，然后将预训练模型迁移到另一个领域并应用于未标注数据（可能在对目标域的少量数据进行额外的监督微调之后）。最后，在无监督学习中，没有真实标签，因为目标是发现数据中的底层结构，根据相似性对它们进行分组。例如，可以对嵌入进行聚类以发现这些关系。</span></p><p><span>监督方法在经济应用中很常见，因为目标通常是使用神经网络从未标注数据中提取某些特征。经济学家也可能继续进行自监督预训练。这最常见于其应用领域与模型预训练领域有显著偏移时 (Gururangan et al. 2020)。例如，分析十八世纪法律文本的经济史学家可能首先在该数据库上继续预训练语言模型（通过预测被掩码的词元），以便更好地理解十八世纪的法律术语。</span></p><p><span>无监督学习对数据探索最有用。在实证经济学中，规范是指定一个狭义定义的假设并进行统计检验，这通常适用于监督应用。然而，使用无监督方法进行系统的数据探索可以成为从新颖的非结构化数据中收集典型事实的强大工具。</span></p><p><span>在进行监督学习时，标注数据进一步分为训练数据（用于训练模型）、验证数据（用于调整模型超参数或选择提示）和测试数据（仅用于计算将在研究结果中报告的模型评估）。研究人员应始终拥有一个高质量、有代表性的测试集来评估模型性能。如果用于评估模型性能的数据不能代表未标注数据集——特别是，如果未标注数据中有相当一部分在标注数据中没有支持——那么模型在评估数据上的性能可能与模型在未标注数据上的性能（这是潜在关注对象）存在很大差异。</span></p><p><span>在理想情况下，可以通过随机抽样创建有代表性的测试集。然而，这并非总是可能，特别是当研究人员想要测量的类别高度不平衡时。假设研究人员需要从一个庞大的网络语料库中提取感兴趣主题的文本，而相关主题每万篇文本中只出现一次。通过随机抽样获得足够阳性样本的标注要求显然是不可行的。这种情况在社会科学中很常见，研究人员经常需要从海量语料库（例如，媒体或政府文件）中对相关信息进行分类，其中只有极小部分内容与感兴趣主题相关。</span></p><p><span>虽然选择信息量最大的样本进行标注的策略已经在机器学习文献中产生了大量关于主动学习的研究（EconDL 在文本分类的背景下提供了详细讨论）；但在类别严重不平衡时，关于如何选择用于训练、评估或去偏差的代表性样本的研究很少。判别式主动学习 (Gissin and Shalev-Shwartz 2019) 选择要标注的样本，以最大化区分标注数据和未标注数据的难度，并且在数据相对平衡时可以很好地工作。它在类别严重不平衡时效果不佳，因为它未能充分抽样稀有类别。其他主动学习方法试图在分类器的决策边界附近抽样，这将抽样稀有类别并可以最大化预测准确性。然而，这将提供一个无代表性的样本。</span></p><p><span>相反，社会科学家经常使用某些关键词的存在来选择要标注的内容。然而，根据构造，这未能对所有实例赋予正的抽样概率，增加了某些类型的未标注数据在标注数据中没有支持的可能性。这可能会产生预测偏差，这种偏差与下游因果估计方程中的误差项系统相关——研究人员打算在该方程中使用深度学习模型预测——因为语义和遗漏变量通常都随时间和空间变化。</span></p><p><span>嵌入模型（第 8 节）——创建文本或图像的向量表示之间距离有意义的空间的深度神经网络——提供了一种度量，可用于对要标注的数据进行分层抽样。文本/图像与关于某个类别的一组查询（例如，“这篇文章是关于税收政策的”）越接近，它来自该类别的概率就越高，使得该空间中的距离对于分层抽样很有用。分层抽样方法还可以为训练提供信息丰富的负样本：预训练模型放置在查询附近但与查询无关（以研究人员意图的方式）的样本。这是一个活跃的研究领域，经济学家有潜力做出重要贡献。EconDL 网站将随着该文献的进展而更新。</span></p><p><span>由于迁移学习的力量，训练数据不一定需要从未标注数据的同一分布中抽取，尽管预测准确性通常会随着目标数据与训练数据之间领域偏移的幅度而下降。通常，已经存在或可以从网络文本中提取的数据集允许以比研究人员手动标注低得多的成本创建更大的训练集。然后通过对目标数据中手工标注的少得多数据集进行进一步微调，确保在目标数据集上的高性能。</span></p><p><span>一致性标注——当两个（或更多）标注者对相同数据点进行标注时——对于确保训练和评估数据的质量很重要。即使是看似简单的任务，一旦应用于现实世界的非结构化数据，也往往比预期的更混乱。一致性标注还确保标注者理解了任务并产生高质量的标签。在具有挑战性的标注任务中，研究人员可能希望所有标注数据都经过双重标注，通过手动解决差异。在更简单的情况下，可能只需要对数据的一个较小子集进行一致性标注，以确保任务定义明确且标注者已正确理解说明。在机器学习论文中，通常期望研究人员报告标注者之间的一致性，并发布标注者说明，这在经济应用中也可能有用。</span></p><h2 id='5-偏差和不确定性量化'><span>5. 偏差和不确定性量化</span></h2><p><span>使用深度学习解决社会或经济问题存在许多局限性（参见，例如，ACM 公平、问责和透明度会议 (</span><a href='https://facctconference.org/' target='_blank' class='url'>https://facctconference.org/</a><span>) 的论文以及 Cui and Athey 2022）。在这里，我们的关注点要窄得多：在原始数据集规模过大而无法手动提取特征的情况下，推算或探索非结构化数据的低维特征，这些特征是人类可能一致同意的。</span></p><p><span>在需要主观判断的背景下应用深度学习时需要谨慎。例如，研究人员已经表明，标注者自我认同的政治取向会影响他们在政治情感标注上的不一致性 (Shen and Rose 2021)。深度学习文献中的情感分类主要围绕笔记本电脑、餐厅和电影评论等背景设计，这些背景通常有关于产品的明确情感，可以通过星级评分来验证。在许多经济学家关心的应用中——例如媒体数据、政治演讲、公司报告等中的情感——情感可能更加隐含，并且人类可能对此意见不一。如果模型被输入反映标注者主观偏差的标注——而不是定义明确的真实情况，或者仅仅因为要做的区分很复杂而没有足够的示例，它将做出可能系统偏差的不准确预测。模型也可能从预训练中继承偏差，并且有大量关于 AI 偏差和公平性的文献 (Mehrabi et al. 2021)。通过坚持具有明确定义真实情况的简单任务，可以缓解这些挑战。</span></p><p><span>经济学家可以在不确定性量化方面做出宝贵贡献，这在许多深度学习文献中并不常见。保形推理可以为预测任务提供不确定性量化。通过收集真实校准数据集，保形方法在温和条件下产生具有边际覆盖保证的预测集。一个经典的教程是 Shafer and Vovk (2008)；参见 Chernozhukov, Wüthrich, and Zhu (2021)、Cattaneo 等人 (2022) 和 Lei and Candès (2021) 了解最近的贡献。</span></p><p><span>渐近动机的推理通常要求模型参数的估计是无偏的，这对通常权衡偏差和方差以产生低均方误差预测的“黑盒”机器学习预测器来说是个问题。半参数推理的长期文献（例如，Robins, Rotnitzky, and Zhao 1994）一直致力于解决这些问题，最终形成了近期关于去偏差机器学习的大量计量经济学文献（例如，Chernozhukov et al. 2018; Chernozhukov, Newey, and Singh 2022）。</span></p><p><span>计量经济学中的去偏差机器学习文献与深度学习领域中关于“预测驱动推理”的文献有许多相似之处（例如，Angelopoulos et al. 2023; Zrnic and Candès 2024）。广义而言，从非结构化数据中推算结构化特征（深度学习文献的重点）和因果推理（计量经济学文献的重点）是更一般的缺失数据推算问题的特例。在因果推理中，潜在结果是缺失的，而在许多深度学习预测应用中，低维结构化特征是缺失的，因为手动从高维非结构化数据中提取它们的成本过高。预测驱动推理文献研究了如何使用目标人群的高质量真实标签辅助样本来对深度学习预测进行去偏差。这些信息用于衡量由推算引起的偏差，然后进行校正，最终使研究人员能够在不牺牲使用在更大数据集上预训练的模型（该模型做出有偏预测）所提供信息的情况下进行有效推理。深度学习模型被视为黑盒。可以证明预测驱动推理框架等价于去偏差机器学习。</span></p><h2 id='6-深度学习中的可重用性和可重复性'><span>6. 深度学习中的可重用性和可重复性</span></h2><p><span>深度学习在很大程度上建立在开放科学和开放数据的基础上，尽管近年来随着该技术的商业潜力日益明显，出现了向专有模型和数据的显著转变。尽管如此，开放资源的数量是惊人的，如果没有模型和数据集的广泛共享，深度学习不可能取得如此大的进步。鉴于迁移学习和大规模预训练的核心地位，没有开放科学，我们所知的这个领域将不复存在。</span></p><p><span>经济学越能在允许数据隐私的情况下围绕大数据创建开放科学文化，我们作为一个专业就越能从迁移学习的正外部性中受益。例如，深度学习研究人员通常有动机尽快在 GitHub 上分享他们的代码，以此主张他们的贡献，或者一旦数据集构建完成就立即发布，以便快速发展的文献能够更长时间地使用它。此外，深度学习领域的出版机构通常要求遵守商定的数据和代码发布的元数据和伦理框架 (Gebru et al. 2021; MLCommons 2024; Mitchell et al. 2019; Holland et al. 2020)。虽然我不主张经济学全盘采用这些标准，但值得考虑是否存在模型和数据集发布的标准，以促进经济学中深度神经模型的可重复性和可重用性。</span></p><p><span>深度学习模型和数据的最大中心是 Hugging Face。在那里可以找到丰富的语言模型和文本数据，其中一些示例在通过 EconDL 链接的演示笔记本中进行了探讨。Hugging Face 最近收购了 timm，这是一个视觉模型的核心存储库，使 Hugging Face 成为许多语言和视觉任务的一站式商店。</span></p><h2 id='7-分类器'><span>7. 分类器</span></h2><p><span>在介绍了深度学习之后，我现在转向应用。分类通常是经济分析不可或缺的一部分。在大数据时代，研究人员可能首先需要使用分类来提取相关数据。例如，他们可能从海量的新闻、社交媒体帖子、财报电话会议或立法记录语料库开始，需要从整个语料库的数百万甚至数十亿文本中仅提取关于利率、移民或高等教育的报道。然后，这个有限得多的语料库被用于提取将在某些下游因果估计方程中使用的度量。虽然这一步通常很少受到关注，但有偏的分类将导致进入下游因果估计方程所用样本的选择偏差，可能显著歪曲结论。或者，研究人员可能使用分类来推算结构化数据——例如，文本中提及的地理位置、它们的情感或主题，或者卫星图像中出现什么类型的物体。</span></p><p><span>本节首先介绍分类器（第 7.1 节），并描述使用生成式 AI 进行分类（第 7.2 节）。然后，它介绍序列分类，其中为文本序列推算一个类别标签：例如，一个句子、段落或文档（第 7.3 节）。它在 19 个不同的文本分类任务上比较了定制训练的分类器与生成式 AI 的性能。分类也可以应用于文本中的单个术语（第 7.4 节）。最后，分类器可用于比较文本之间的关系（第 7.5 节）。为了便于阐述，我侧重于文本分类。图像分类——对完整图像或图像内的像素或物体进行分类——是类似的，使用 CNN 或视觉 Transformer 而不是语言 Transformer。这在 EconDL 知识库中题为“卷积神经网络”的帖子中有深入介绍。</span></p><h3 id='71-分类器简介'><span>7.1 分类器简介</span></h3><p><span>在传统分类中，神经网络为 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-95-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-95-TEX-I-1D441"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">N</script><span> 个类别中的每一个预测一个分数，输入被分配给分数最高的类别。对于不熟悉分类器的人，Sanderson (n.d.) 在数字图像分类的背景下提供了出色的图形化处理。</span></p><p><span>回想一下神经网络就像乐高积木的比喻。Transformer 模型力量的核心在于能够使用同一个预训练语言模型作为各种分类任务的主干。这在图 3 中有所说明。一个 Transformer 语言模型为其输入中的每个词元（单词或子词）产生一个向量表示，以及总结整个输入文本的 </span><code>&lt;cls&gt;</code><span> 表示。可以通过向 </span><code>&lt;cls&gt;</code><span> 表示添加一个分类器头来对文本序列进行分类（面板 A）。分类器是一个前馈神经网络，它使用学习到的权重将 </span><code>&lt;cls&gt;</code><span> 向量中的节点聚合成每个类别的分数。如图 3 面板 C 所示，同样可以通过向它们的向量表示添加分类器头来对单个词元进行分类。或者，两个文本可以联合嵌入，然后可以向 </span><code>&lt;cls&gt;</code><span> 表示添加一个分类器来分类它们之间的关系（面板 B）。</span></p><p><span>训练分类器是深度学习中最直接的任务之一。开源软件包 LinkTransformer 可用于训练文本序列分类器，并通过 EconDL 提供演示。虽然训练分类器时基础 Transformer 语言模型可以被冻结，并且 Transformer 的各个层可以用作分类器的输入，但通常允许所有参数更新，分类器层附加到 Transformer 的最后一层。分类器可以是二元的（两个类别）、多类的（多于两个类别，其中只有一个为阳性）或多标签的（多个类别可以为阳性）。</span></p><p><span>分类器训练是一项监督任务，模型必须在训练期间看到来自每个类别的足够数量的示例，才能在未标注数据上表现良好。当为分类创建标签时，标注数据在各个类别之间应相对平衡（例如，在二元分类的情况下，阳性和阴性样本）。</span></p><p><span>为了训练分类器，我们还需要一个合适的损失函数。分类中最常见的两种损失是支持向量机 (SVM) 损失（也称为合页损失）和交叉熵损失。</span></p><p><span>给定一个真实标签为 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.848ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 817 647" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.464ex;"><defs><path id="MJX-67-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-67-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-67-TEX-I-1D466"></use></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-67-TEX-I-1D456"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">y_i</script><span> 的样本以及神经网络产生的类别分数向量 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 503 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-68-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-68-TEX-I-1D45D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">p</script><span>，SVM 损失为：</span>
<mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="31.982ex" height="2.686ex" role="img" focusable="false" viewBox="0 -750 14135.9 1187.4" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.99ex;"><defs><path id="MJX-69-TEX-I-1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-69-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-69-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-69-TEX-SO-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path id="MJX-69-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path id="MJX-69-TEX-N-2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path><path id="MJX-69-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-69-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-69-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-69-TEX-N-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path><path id="MJX-69-TEX-N-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path id="MJX-69-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-69-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-69-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-69-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-69-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-69-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-69-TEX-N-7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path><path id="MJX-69-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43F" xlink:href="#MJX-69-TEX-I-1D43F"></use></g><g data-mml-node="mi" transform="translate(714,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-69-TEX-I-1D456"></use></g></g><g data-mml-node="mo" transform="translate(1285.7,0)"><use data-c="3D" xlink:href="#MJX-69-TEX-N-3D"></use></g><g data-mml-node="munder" transform="translate(2341.5,0)"><g data-mml-node="mo"><use data-c="2211" xlink:href="#MJX-69-TEX-SO-2211"></use></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-69-TEX-I-1D457"></use></g><g data-mml-node="mo" transform="translate(412,0)"><use data-c="2260" xlink:href="#MJX-69-TEX-N-2260"></use></g><g data-mml-node="msub" transform="translate(1190,0)"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-69-TEX-I-1D466"></use></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-69-TEX-I-1D456"></use></g></g></g></g><g data-mml-node="mo" transform="translate(5066.3,0)"><use data-c="6D" xlink:href="#MJX-69-TEX-N-6D"></use><use data-c="61" xlink:href="#MJX-69-TEX-N-61" transform="translate(833,0)"></use><use data-c="78" xlink:href="#MJX-69-TEX-N-78" transform="translate(1333,0)"></use></g><g data-mml-node="mo" transform="translate(6927.3,0)"><use data-c="7B" xlink:href="#MJX-69-TEX-N-7B"></use></g><g data-mml-node="mn" transform="translate(7427.3,0)"><use data-c="30" xlink:href="#MJX-69-TEX-N-30"></use></g><g data-mml-node="mo" transform="translate(7927.3,0)"><use data-c="2C" xlink:href="#MJX-69-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(8372,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-69-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><use data-c="1D457" xlink:href="#MJX-69-TEX-I-1D457"></use></g></g><g data-mml-node="mo" transform="translate(9471.5,0)"><use data-c="2212" xlink:href="#MJX-69-TEX-N-2212"></use></g><g data-mml-node="msub" transform="translate(10471.7,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-69-TEX-I-1D45D"></use></g><g data-mml-node="TeXAtom" transform="translate(536,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-69-TEX-I-1D466"></use></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-69-TEX-I-1D456"></use></g></g></g></g><g data-mml-node="mo" transform="translate(11857.6,0)"><use data-c="2B" xlink:href="#MJX-69-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(12857.9,0)"><use data-c="31" xlink:href="#MJX-69-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(13357.9,0)"><use data-c="7D" xlink:href="#MJX-69-TEX-N-7D"></use></g><g data-mml-node="mo" transform="translate(13857.9,0)"><use data-c="2E" xlink:href="#MJX-69-TEX-N-2E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><munder><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></munder><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><msub><mi>p</mi><mi>j</mi></msub><mo>−</mo><msub><mi>p</mi><mrow data-mjx-texclass="ORD"><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo><mo>.</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex"> L_i = \sum_{j \neq y_i} \max\{0, p_j - p_{y_i} + 1\}. </script>
<span>该损失对错误类别求和，如果正确类别的分数至少不比错误类别的分数高某个阈值，则施加惩罚。阈值可以设为 1 而不失一般性，因为它只是缩放学习到的权重。</span></p><p><span>交叉熵损失衡量预测分数分布与真实分布之间的差异。考虑一个用于具有 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.719ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 760 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-70-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D436" xlink:href="#MJX-70-TEX-I-1D436"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">C</script><span> 个类别的多类分类问题的神经网络。设 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.109ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 490 647" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.464ex;"><defs><path id="MJX-80-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-80-TEX-I-1D466"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">y</script><span> 为一个样本的真实标签，表示为一个独热编码向量。对于一个属于类别 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewBox="0 -661 345 672" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-77-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-77-TEX-I-1D456"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">i</script><span> 的样本，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.997ex" height="1.971ex" role="img" focusable="false" viewBox="0 -666 2650.5 871" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.464ex;"><defs><path id="MJX-73-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-73-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-73-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-73-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-73-TEX-I-1D466"></use></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-73-TEX-I-1D456"></use></g></g><g data-mml-node="mo" transform="translate(1094.7,0)"><use data-c="3D" xlink:href="#MJX-73-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(2150.5,0)"><use data-c="31" xlink:href="#MJX-73-TEX-N-31"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container><script type="math/tex">y_i = 1</script><span> 且对于 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.73ex" height="2.106ex" role="img" focusable="false" viewBox="0 -716 2090.6 931" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.486ex;"><defs><path id="MJX-74-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path id="MJX-74-TEX-N-2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path><path id="MJX-74-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-74-TEX-I-1D457"></use></g><g data-mml-node="mo" transform="translate(689.8,0)"><use data-c="2260" xlink:href="#MJX-74-TEX-N-2260"></use></g><g data-mml-node="mi" transform="translate(1745.6,0)"><use data-c="1D456" xlink:href="#MJX-74-TEX-I-1D456"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>≠</mo><mi>i</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">j \neq i</script><span>，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.104ex" height="2.173ex" role="img" focusable="false" viewBox="0 -666 2697.9 960.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.666ex;"><defs><path id="MJX-75-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-75-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path id="MJX-75-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-75-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-75-TEX-I-1D466"></use></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><use data-c="1D457" xlink:href="#MJX-75-TEX-I-1D457"></use></g></g><g data-mml-node="mo" transform="translate(1142.1,0)"><use data-c="3D" xlink:href="#MJX-75-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(2197.9,0)"><use data-c="30" xlink:href="#MJX-75-TEX-N-30"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></math></mjx-assistive-mml></mjx-container><script type="math/tex">y_j = 0</script><span>。设 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.052ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 465 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-76-TEX-I-1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D467" xlink:href="#MJX-76-TEX-I-1D467"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">z</script><span> 为该样本由神经网络产生的原始数字（通常称为 logits）。分类层将为每个类别产生一个分数。使用 softmax 函数获得的类别 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewBox="0 -661 345 672" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-77-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-77-TEX-I-1D456"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">i</script><span> 的预测分数为：</span>
<mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="12.484ex" height="3.858ex" role="img" focusable="false" viewBox="0 -871.7 5518 1705.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -1.886ex;"><defs><path id="MJX-78-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-78-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-78-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-78-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-78-TEX-I-1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"></path><path id="MJX-78-TEX-SO-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path id="MJX-78-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJX-78-TEX-I-1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path id="MJX-78-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-78-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-78-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-78-TEX-I-1D456"></use></g></g><g data-mml-node="mo" transform="translate(1107.7,0)"><use data-c="3D" xlink:href="#MJX-78-TEX-N-3D"></use></g><g data-mml-node="mfrac" transform="translate(2163.5,0)"><g data-mml-node="msup" transform="translate(1120.9,394) scale(0.707)"><g data-mml-node="mi"><use data-c="1D452" xlink:href="#MJX-78-TEX-I-1D452"></use></g><g data-mml-node="TeXAtom" transform="translate(499,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D467" xlink:href="#MJX-78-TEX-I-1D467"></use></g><g data-mml-node="mi" transform="translate(498,-307.4)"><use data-c="1D456" xlink:href="#MJX-78-TEX-I-1D456"></use></g></g></g></g><g data-mml-node="mrow" transform="translate(220,-529.8) scale(0.707)"><g data-mml-node="munderover"><g data-mml-node="mo"><use data-c="2211" xlink:href="#MJX-78-TEX-SO-2211"></use></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D436" xlink:href="#MJX-78-TEX-I-1D436"></use></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D457" xlink:href="#MJX-78-TEX-I-1D457"></use></g><g data-mml-node="mo" transform="translate(412,0)"><use data-c="3D" xlink:href="#MJX-78-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(1190,0)"><use data-c="31" xlink:href="#MJX-78-TEX-N-31"></use></g></g></g><g data-mml-node="msup" transform="translate(2500.7,0)"><g data-mml-node="mi"><use data-c="1D452" xlink:href="#MJX-78-TEX-I-1D452"></use></g><g data-mml-node="TeXAtom" transform="translate(499,472.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D467" xlink:href="#MJX-78-TEX-I-1D467"></use></g><g data-mml-node="mi" transform="translate(498,-307.4)"><use data-c="1D457" xlink:href="#MJX-78-TEX-I-1D457"></use></g></g></g></g></g><rect width="2836.4" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(5240,0)"><use data-c="2E" xlink:href="#MJX-78-TEX-N-2E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mfrac><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><msub><mi>z</mi><mi>i</mi></msub></mrow></msup><mrow><munderover><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>C</mi></mrow></munderover><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><msub><mi>z</mi><mi>j</mi></msub></mrow></msup></mrow></mfrac><mo>.</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex"> p_i = \frac{e^{z_i}}{\sum_{j=1}^{C} e^{z_j}}. </script>
<span>虽然类别分数在文献中经常被称为“概率”，但它们不是统计学意义上的概率。它们的尖锐程度将取决于神经网络的正则化。</span></p><p><span>真实标签与预测分布之间的交叉熵损失为：</span>
<mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="28.653ex" height="2.984ex" role="img" focusable="false" viewBox="0 -975.6 12664.4 1318.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.777ex;"><defs><path id="MJX-79-TEX-N-43" d="M56 342Q56 428 89 500T174 615T283 681T391 705Q394 705 400 705T408 704Q499 704 569 636L582 624L612 663Q639 700 643 704Q644 704 647 704T653 705H657Q660 705 666 699V419L660 413H626Q620 419 619 430Q610 512 571 572T476 651Q457 658 426 658Q322 658 252 588Q173 509 173 342Q173 221 211 151Q232 111 263 84T328 45T384 29T428 24Q517 24 571 93T626 244Q626 251 632 257H660L666 251V236Q661 133 590 56T403 -21Q262 -21 159 83T56 342Z"></path><path id="MJX-79-TEX-N-45" d="M128 619Q121 626 117 628T101 631T58 634H25V680H597V676Q599 670 611 560T625 444V440H585V444Q584 447 582 465Q578 500 570 526T553 571T528 601T498 619T457 629T411 633T353 634Q266 634 251 633T233 622Q233 622 233 621Q232 619 232 497V376H286Q359 378 377 385Q413 401 416 469Q416 471 416 473V493H456V213H416V233Q415 268 408 288T383 317T349 328T297 330Q290 330 286 330H232V196V114Q232 57 237 52Q243 47 289 47H340H391Q428 47 452 50T505 62T552 92T584 146Q594 172 599 200T607 247T612 270V273H652V270Q651 267 632 137T610 3V0H25V46H58Q100 47 109 49T128 61V619Z"></path><path id="MJX-79-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-79-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-79-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-79-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-79-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-79-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-79-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-79-TEX-SO-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path id="MJX-79-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJX-79-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-79-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-79-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-79-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-79-TEX-N-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path><path id="MJX-79-TEX-N-2061" d=""></path><path id="MJX-79-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="43" xlink:href="#MJX-79-TEX-N-43"></use><use data-c="45" xlink:href="#MJX-79-TEX-N-45" transform="translate(722,0)"></use></g><g data-mml-node="mo" transform="translate(1403,0)"><use data-c="28" xlink:href="#MJX-79-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1792,0)"><use data-c="1D466" xlink:href="#MJX-79-TEX-I-1D466"></use></g><g data-mml-node="mo" transform="translate(2282,0)"><use data-c="2C" xlink:href="#MJX-79-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(2726.7,0)"><use data-c="1D45D" xlink:href="#MJX-79-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(3229.7,0)"><use data-c="29" xlink:href="#MJX-79-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3896.4,0)"><use data-c="3D" xlink:href="#MJX-79-TEX-N-3D"></use></g><g data-mml-node="mo" transform="translate(4952.2,0)"><use data-c="2212" xlink:href="#MJX-79-TEX-N-2212"></use></g><g data-mml-node="munderover" transform="translate(5896.9,0)"><g data-mml-node="mo"><use data-c="2211" xlink:href="#MJX-79-TEX-SO-2211"></use></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D436" xlink:href="#MJX-79-TEX-I-1D436"></use></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-79-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="3D" xlink:href="#MJX-79-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-79-TEX-N-31"></use></g></g></g><g data-mml-node="msub" transform="translate(8350.2,0)"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-79-TEX-I-1D466"></use></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-79-TEX-I-1D456"></use></g></g><g data-mml-node="mi" transform="translate(9333.8,0)"><use data-c="6C" xlink:href="#MJX-79-TEX-N-6C"></use><use data-c="6F" xlink:href="#MJX-79-TEX-N-6F" transform="translate(278,0)"></use><use data-c="67" xlink:href="#MJX-79-TEX-N-67" transform="translate(778,0)"></use></g><g data-mml-node="mo" transform="translate(10611.8,0)"><use data-c="2061" xlink:href="#MJX-79-TEX-N-2061"></use></g><g data-mml-node="mrow" transform="translate(10778.5,0)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-79-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-79-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(536,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-79-TEX-I-1D456"></use></g></g><g data-mml-node="mo" transform="translate(1219,0)"><use data-c="29" xlink:href="#MJX-79-TEX-N-29"></use></g></g><g data-mml-node="mo" transform="translate(12386.4,0)"><use data-c="2E" xlink:href="#MJX-79-TEX-N-2E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>CE</mtext><mo stretchy="false">(</mo><mi>y</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>C</mi></mrow></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo>.</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex"> \text{CE}(y, p) = - \sum_{i=1}^{C} y_i \log(p_i). </script>
<span>由于 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.109ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 490 647" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.464ex;"><defs><path id="MJX-80-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D466" xlink:href="#MJX-80-TEX-I-1D466"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">y</script><span> 是独热向量，这简化为：</span>
<mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="26.79ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 11841 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-81-TEX-N-43" d="M56 342Q56 428 89 500T174 615T283 681T391 705Q394 705 400 705T408 704Q499 704 569 636L582 624L612 663Q639 700 643 704Q644 704 647 704T653 705H657Q660 705 666 699V419L660 413H626Q620 419 619 430Q610 512 571 572T476 651Q457 658 426 658Q322 658 252 588Q173 509 173 342Q173 221 211 151Q232 111 263 84T328 45T384 29T428 24Q517 24 571 93T626 244Q626 251 632 257H660L666 251V236Q661 133 590 56T403 -21Q262 -21 159 83T56 342Z"></path><path id="MJX-81-TEX-N-45" d="M128 619Q121 626 117 628T101 631T58 634H25V680H597V676Q599 670 611 560T625 444V440H585V444Q584 447 582 465Q578 500 570 526T553 571T528 601T498 619T457 629T411 633T353 634Q266 634 251 633T233 622Q233 622 233 621Q232 619 232 497V376H286Q359 378 377 385Q413 401 416 469Q416 471 416 473V493H456V213H416V233Q415 268 408 288T383 317T349 328T297 330Q290 330 286 330H232V196V114Q232 57 237 52Q243 47 289 47H340H391Q428 47 452 50T505 62T552 92T584 146Q594 172 599 200T607 247T612 270V273H652V270Q651 267 632 137T610 3V0H25V46H58Q100 47 109 49T128 61V619Z"></path><path id="MJX-81-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-81-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-81-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-81-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-81-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-81-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-81-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-81-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-81-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-81-TEX-N-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path><path id="MJX-81-TEX-N-2061" d=""></path><path id="MJX-81-TEX-N-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path><path id="MJX-81-TEX-N-72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z"></path><path id="MJX-81-TEX-N-75" d="M383 58Q327 -10 256 -10H249Q124 -10 105 89Q104 96 103 226Q102 335 102 348T96 369Q86 385 36 385H25V408Q25 431 27 431L38 432Q48 433 67 434T105 436Q122 437 142 438T172 441T184 442H187V261Q188 77 190 64Q193 49 204 40Q224 26 264 26Q290 26 311 35T343 58T363 90T375 120T379 144Q379 145 379 161T380 201T380 248V315Q380 361 370 372T320 385H302V431Q304 431 378 436T457 442H464V264Q464 84 465 81Q468 61 479 55T524 46H542V0Q540 0 467 -5T390 -11H383V58Z"></path><path id="MJX-81-TEX-N-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path><path id="MJX-81-TEX-N-20" d=""></path><path id="MJX-81-TEX-N-63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path><path id="MJX-81-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-81-TEX-N-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="43" xlink:href="#MJX-81-TEX-N-43"></use><use data-c="45" xlink:href="#MJX-81-TEX-N-45" transform="translate(722,0)"></use></g><g data-mml-node="mo" transform="translate(1403,0)"><use data-c="28" xlink:href="#MJX-81-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1792,0)"><use data-c="1D466" xlink:href="#MJX-81-TEX-I-1D466"></use></g><g data-mml-node="mo" transform="translate(2282,0)"><use data-c="2C" xlink:href="#MJX-81-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(2726.7,0)"><use data-c="1D45D" xlink:href="#MJX-81-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(3229.7,0)"><use data-c="29" xlink:href="#MJX-81-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3896.4,0)"><use data-c="3D" xlink:href="#MJX-81-TEX-N-3D"></use></g><g data-mml-node="mo" transform="translate(4952.2,0)"><use data-c="2212" xlink:href="#MJX-81-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(5896.9,0)"><use data-c="6C" xlink:href="#MJX-81-TEX-N-6C"></use><use data-c="6F" xlink:href="#MJX-81-TEX-N-6F" transform="translate(278,0)"></use><use data-c="67" xlink:href="#MJX-81-TEX-N-67" transform="translate(778,0)"></use></g><g data-mml-node="mo" transform="translate(7174.9,0)"><use data-c="2061" xlink:href="#MJX-81-TEX-N-2061"></use></g><g data-mml-node="mrow" transform="translate(7341.6,0)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-81-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-81-TEX-I-1D45D"></use></g><g data-mml-node="TeXAtom" transform="translate(536,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="74" xlink:href="#MJX-81-TEX-N-74"></use><use data-c="72" xlink:href="#MJX-81-TEX-N-72" transform="translate(389,0)"></use><use data-c="75" xlink:href="#MJX-81-TEX-N-75" transform="translate(781,0)"></use><use data-c="65" xlink:href="#MJX-81-TEX-N-65" transform="translate(1337,0)"></use><use data-c="20" xlink:href="#MJX-81-TEX-N-20" transform="translate(1781,0)"></use><use data-c="63" xlink:href="#MJX-81-TEX-N-63" transform="translate(2031,0)"></use><use data-c="6C" xlink:href="#MJX-81-TEX-N-6C" transform="translate(2475,0)"></use><use data-c="61" xlink:href="#MJX-81-TEX-N-61" transform="translate(2753,0)"></use><use data-c="73" xlink:href="#MJX-81-TEX-N-73" transform="translate(3253,0)"></use><use data-c="73" xlink:href="#MJX-81-TEX-N-73" transform="translate(3647,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(3832.4,0)"><use data-c="29" xlink:href="#MJX-81-TEX-N-29"></use></g></g><g data-mml-node="mo" transform="translate(11563,0)"><use data-c="2C" xlink:href="#MJX-81-TEX-N-2C"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>CE</mtext><mo stretchy="false">(</mo><mi>y</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi>p</mi><mrow data-mjx-texclass="ORD"><mtext>true class</mtext></mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo>,</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex"> \text{CE}(y, p) = -\log(p_{\text{true class}}), </script>
<span>其中 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.791ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 3443.4 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-82-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-82-TEX-N-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path><path id="MJX-82-TEX-N-72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z"></path><path id="MJX-82-TEX-N-75" d="M383 58Q327 -10 256 -10H249Q124 -10 105 89Q104 96 103 226Q102 335 102 348T96 369Q86 385 36 385H25V408Q25 431 27 431L38 432Q48 433 67 434T105 436Q122 437 142 438T172 441T184 442H187V261Q188 77 190 64Q193 49 204 40Q224 26 264 26Q290 26 311 35T343 58T363 90T375 120T379 144Q379 145 379 161T380 201T380 248V315Q380 361 370 372T320 385H302V431Q304 431 378 436T457 442H464V264Q464 84 465 81Q468 61 479 55T524 46H542V0Q540 0 467 -5T390 -11H383V58Z"></path><path id="MJX-82-TEX-N-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path><path id="MJX-82-TEX-N-20" d=""></path><path id="MJX-82-TEX-N-63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path><path id="MJX-82-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-82-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-82-TEX-N-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-82-TEX-I-1D45D"></use></g><g data-mml-node="TeXAtom" transform="translate(536,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="74" xlink:href="#MJX-82-TEX-N-74"></use><use data-c="72" xlink:href="#MJX-82-TEX-N-72" transform="translate(389,0)"></use><use data-c="75" xlink:href="#MJX-82-TEX-N-75" transform="translate(781,0)"></use><use data-c="65" xlink:href="#MJX-82-TEX-N-65" transform="translate(1337,0)"></use><use data-c="20" xlink:href="#MJX-82-TEX-N-20" transform="translate(1781,0)"></use><use data-c="63" xlink:href="#MJX-82-TEX-N-63" transform="translate(2031,0)"></use><use data-c="6C" xlink:href="#MJX-82-TEX-N-6C" transform="translate(2475,0)"></use><use data-c="61" xlink:href="#MJX-82-TEX-N-61" transform="translate(2753,0)"></use><use data-c="73" xlink:href="#MJX-82-TEX-N-73" transform="translate(3253,0)"></use><use data-c="73" xlink:href="#MJX-82-TEX-N-73" transform="translate(3647,0)"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow data-mjx-texclass="ORD"><mtext>true class</mtext></mrow></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">p_{\text{true class}}</script><span> 是正确类别的预测概率。</span></p><p><span>对于 SVM 损失，一旦正确类别的分数超过阈值，它对进一步提高正确类别的分数就漠不关心。另一方面，交叉熵损失将正确类别推向 1。这意味着在训练的早期阶段，准确率可能会突然增加，而损失没有显著变化。在现实场景中，两种损失通常产生可比较的结果。</span></p><p><span>二元分类器使用 F1 分数进行评估，这是一个结合了召回率（真阳性除以真阳性加假阴性）和精确率（真阳性除以真阳性加假阳性）的度量。</span>
<mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="22.275ex" height="3.281ex" role="img" focusable="false" viewBox="0 -967.9 9845.6 1450.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -1.091ex;"><defs><path id="MJX-83-TEX-N-46" d="M128 619Q121 626 117 628T101 631T58 634H25V680H582V676Q584 670 596 560T610 444V440H570V444Q563 493 561 501Q555 538 543 563T516 601T477 622T431 631T374 633H334H286Q252 633 244 631T233 621Q232 619 232 490V363H284Q287 363 303 363T327 364T349 367T372 373T389 385Q407 403 410 459V480H450V200H410V221Q407 276 389 296Q381 303 371 307T348 313T327 316T303 317T284 317H232V189L233 61Q240 54 245 52T270 48T333 46H360V0H348Q324 3 182 3Q51 3 36 0H25V46H58Q100 47 109 49T128 61V619Z"></path><path id="MJX-83-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-83-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-83-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-83-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-83-TEX-N-70" d="M36 -148H50Q89 -148 97 -134V-126Q97 -119 97 -107T97 -77T98 -38T98 6T98 55T98 106Q98 140 98 177T98 243T98 296T97 335T97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 61 434T98 436Q115 437 135 438T165 441T176 442H179V416L180 390L188 397Q247 441 326 441Q407 441 464 377T522 216Q522 115 457 52T310 -11Q242 -11 190 33L182 40V-45V-101Q182 -128 184 -134T195 -145Q216 -148 244 -148H260V-194H252L228 -193Q205 -192 178 -192T140 -191Q37 -191 28 -194H20V-148H36ZM424 218Q424 292 390 347T305 402Q234 402 182 337V98Q222 26 294 26Q345 26 384 80T424 218Z"></path><path id="MJX-83-TEX-N-72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z"></path><path id="MJX-83-TEX-N-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path><path id="MJX-83-TEX-N-63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path><path id="MJX-83-TEX-N-69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path><path id="MJX-83-TEX-N-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path><path id="MJX-83-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-83-TEX-N-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-83-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-83-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-83-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-83-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="46" xlink:href="#MJX-83-TEX-N-46"></use><use data-c="31" xlink:href="#MJX-83-TEX-N-31" transform="translate(653,0)"></use></g><g data-mml-node="mo" transform="translate(1430.8,0)"><use data-c="3D" xlink:href="#MJX-83-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(2486.6,0)"><use data-c="32" xlink:href="#MJX-83-TEX-N-32"></use></g><g data-mml-node="mo" transform="translate(3208.8,0)"><use data-c="D7" xlink:href="#MJX-83-TEX-N-D7"></use></g><g data-mml-node="mfrac" transform="translate(4209,0)"><g data-mml-node="mrow" transform="translate(220,477.2) scale(0.707)"><g data-mml-node="mtext"><use data-c="70" xlink:href="#MJX-83-TEX-N-70"></use><use data-c="72" xlink:href="#MJX-83-TEX-N-72" transform="translate(556,0)"></use><use data-c="65" xlink:href="#MJX-83-TEX-N-65" transform="translate(948,0)"></use><use data-c="63" xlink:href="#MJX-83-TEX-N-63" transform="translate(1392,0)"></use><use data-c="69" xlink:href="#MJX-83-TEX-N-69" transform="translate(1836,0)"></use><use data-c="73" xlink:href="#MJX-83-TEX-N-73" transform="translate(2114,0)"></use><use data-c="69" xlink:href="#MJX-83-TEX-N-69" transform="translate(2508,0)"></use><use data-c="6F" xlink:href="#MJX-83-TEX-N-6F" transform="translate(2786,0)"></use><use data-c="6E" xlink:href="#MJX-83-TEX-N-6E" transform="translate(3286,0)"></use></g><g data-mml-node="mo" transform="translate(3842,0)"><use data-c="D7" xlink:href="#MJX-83-TEX-N-D7"></use></g><g data-mml-node="mtext" transform="translate(4620,0)"><use data-c="72" xlink:href="#MJX-83-TEX-N-72"></use><use data-c="65" xlink:href="#MJX-83-TEX-N-65" transform="translate(392,0)"></use><use data-c="63" xlink:href="#MJX-83-TEX-N-63" transform="translate(836,0)"></use><use data-c="61" xlink:href="#MJX-83-TEX-N-61" transform="translate(1280,0)"></use><use data-c="6C" xlink:href="#MJX-83-TEX-N-6C" transform="translate(1780,0)"></use><use data-c="6C" xlink:href="#MJX-83-TEX-N-6C" transform="translate(2058,0)"></use></g></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mtext"><use data-c="70" xlink:href="#MJX-83-TEX-N-70"></use><use data-c="72" xlink:href="#MJX-83-TEX-N-72" transform="translate(556,0)"></use><use data-c="65" xlink:href="#MJX-83-TEX-N-65" transform="translate(948,0)"></use><use data-c="63" xlink:href="#MJX-83-TEX-N-63" transform="translate(1392,0)"></use><use data-c="69" xlink:href="#MJX-83-TEX-N-69" transform="translate(1836,0)"></use><use data-c="73" xlink:href="#MJX-83-TEX-N-73" transform="translate(2114,0)"></use><use data-c="69" xlink:href="#MJX-83-TEX-N-69" transform="translate(2508,0)"></use><use data-c="6F" xlink:href="#MJX-83-TEX-N-6F" transform="translate(2786,0)"></use><use data-c="6E" xlink:href="#MJX-83-TEX-N-6E" transform="translate(3286,0)"></use></g><g data-mml-node="mo" transform="translate(3842,0)"><use data-c="2B" xlink:href="#MJX-83-TEX-N-2B"></use></g><g data-mml-node="mtext" transform="translate(4620,0)"><use data-c="72" xlink:href="#MJX-83-TEX-N-72"></use><use data-c="65" xlink:href="#MJX-83-TEX-N-65" transform="translate(392,0)"></use><use data-c="63" xlink:href="#MJX-83-TEX-N-63" transform="translate(836,0)"></use><use data-c="61" xlink:href="#MJX-83-TEX-N-61" transform="translate(1280,0)"></use><use data-c="6C" xlink:href="#MJX-83-TEX-N-6C" transform="translate(1780,0)"></use><use data-c="6C" xlink:href="#MJX-83-TEX-N-6C" transform="translate(2058,0)"></use></g></g><rect width="5118.6" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(9567.6,0)"><use data-c="2E" xlink:href="#MJX-83-TEX-N-2E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>F1</mtext><mo>=</mo><mn>2</mn><mo>×</mo><mfrac><mrow><mtext>precision</mtext><mo>×</mo><mtext>recall</mtext></mrow><mrow><mtext>precision</mtext><mo>+</mo><mtext>recall</mtext></mrow></mfrac><mo>.</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex"> \text{F1} = 2 \times \frac{\text{precision} \times \text{recall}}{\text{precision} + \text{recall}}. </script>
<span>完美的精确率和召回率产生 F1 分数为 1，而最差的分数为 0。F1 是精确率和召回率的调和平均数，因此往往更接近这两个度量中较小的那个。如果精确率或召回率低，F1 分数也会低。F1 优于准确率，因为如果类别不平衡，仅通过总是预测多数类别就可以获得高准确率。</span></p><p><span>当使用具有两个以上类别的分类器时，可以单独计算每个类别的 F1 分数，然后以不同方式组合。一种方法是宏平均 F1，其中每个类别的 F1 分数被平等平均。另一种方法是加权 F1，其中每个类别的 F1 分数按其真实实例数量加权。第三种选择是微平均 F1，其中跨所有类别聚合全局真阳性、假阳性和假阴性，并像二元分类一样计算 F1。当希望跨类别性能相同时，宏平均 F1 最合适；而当数据集不平衡且更频繁类别的性能最重要时，加权或微平均 F1 是更好的选择。</span></p><h3 id='72-用于分类的生成式-ai'><span>7.2 用于分类的生成式 AI</span></h3><p><span>像 GPT、Claude 或 Llama 这样的大型生成式 AI 模型（在文献中通常称为基础模型）使用解码器 Transformer 架构（第 3.5 节）在给定提示的情况下自回归生成文本。在实践中，它们也可能通过检索增强语言建模 (RALM) 设置连接到外部数据库（例如，互联网）（EconDL 中关于检索的帖子包含更多关于 RALM 的信息）。从根本意义上讲，这些模型正在执行分类，在每个时间步自回归地预测离散词汇表中最可能的下一个词元。默认情况下，像 GPT 这样的模型是随机的；它们从最可能词元的分布中预测下一个词元。</span><sup class='md-footnote'><a href='#dfref-footnote-3' name='ref-footnote-3'>3</a></sup></p><p><span>要使用生成式 AI 执行分类任务，用户需要提示模型。在许多方面，提示生成式语言模型比通过梯度下降调优分类器更不直接，因为离散提示的空间是无限的，并且提示已经产生了大量且难以处理的文献。</span></p><p><span>有几个清晰的见解值得强调。核心是，提示调优应在验证集上进行，绝不能在用于评估性能的测试集上进行。后者可能会使提示过度拟合测试集的特殊性，使其在测试集上的性能不能代表在未标注数据上的性能。</span></p><p><span>关于思维链提示的文献建议将任务分解为简单步骤，使其更易于消化 (Wei et al. 2022)。这与我的经验非常吻合，简单的提示比冗长和详细的提示效果要好得多。如果一个问题需要冗长的说明，尝试将其分解为多个问题，在每一步提示模型。还有关于为生成式 LLMs 演示任务的文献（例如，Khattab 等人 2022）。这是否有用将取决于任务的性质，我建议使用验证集检查演示是否有帮助。Liu 等人 (2023) 提供了关于提示工程的综述。对于像 GPT 这样的自回归模型，他们推荐前缀提示；例如，“我喜欢这门课。这篇评论的情感是什么？”这与完形填空提示形成对比：“我喜欢这门课，这是一门 [z] 课。”</span></p><p><span>本文研究了 GPT-3.5 和 GPT-4 在历史报纸文章主题分类上的性能。在过去一年中，我用更旧和更新的模型以及 GPT-4o 和 GPT-4 Turbo 进行了这个练习。GPT-4 和 GPT-4o 表现相似，略优于 Turbo。GPT-4o mini 表现更差。我没有看到新版本有任何系统性的改进。您的体验可能有所不同，因为到本文发表时，无疑会有新的版本可用。</span></p><p><span>我还检查了来自 Anthropic 的另外两个领先的 AI 模型：Claude Haiku 和 Claude Opus。这些导致性能显著下降（F1 分数通常比 GPT 低 10-40 分），由于空间限制未报告。这种较低性能的驱动因素有两个。首先，Claude 拒绝为其评估为有害的文本产生输出。Claude 的一个显著特点是其“宪法 AI”框架，该框架设定了某些伦理原则（例如，无害性要求回应应该是和平的、伦理的，并避免在非西方文化中可能被视为冒犯的内容）。一些关于过去冲突的文章（主要是客观报道事件）和一系列其他主题（例如，关于 1960 年代避孕药引入的内容）被认为是“有害的”。此外，Claude 并不总是生成所需的“是/否”格式，使得无法提取文章是否与主题相关。这两种行为在 GPT 中都没有出现。也许可以通过更多的提示调优来修复，或者随着新版本的发布而改变。</span></p><p><span>无论如何，对于分类器，通常相当直接地解释它为什么会犯特定的错误以及如何修复它们（通过为它混淆的实例类型添加更多训练数据），而目前的 GenAI 感觉更像一个黑盒。幕后有更多的事情发生，模型通过强化学习训练以产生被训练模型的商业实体认为理想的回应。这对于给定的学术应用可能构成问题，也可能不构成问题，并强调了使用测试集进行严格评估的重要性。</span></p><p><span>生成式 AI 用于分类的优点有：(i) 启动成本低，需要最少的编程专业知识或对幕后发生的事情的理解，以及 (ii) 它可以零样本使用（无需用户提供训练数据），而调优分类器需要训练数据。我们将看到，如果有的话，定制训练的分类器在文本分类上往往具有性能优势，但简单的任务可以用生成式 AI 很好地执行。这与广泛的共识一致，即只要有足够的高质量训练数据，通常可以在监督任务上达到人类水平的性能。</span></p><p><span>这让我们想到生成式 AI 的潜在缺点。使用 API 背后的大型模型无法提供与训练分类器相同的细粒度控制。虽然像 GPT 这样的模型允许用户将模型暴露给经验示例，但对于本文中的实验，这并没有带来性能的改进。目前尚不完全清楚通过提示进行演示如何调节这些模型，而提供训练示例如何通过梯度下降更新分类器则是清晰的。并非所有模型在暴露于相同数量的训练数据时都能同样地学习（如第 10 节中的实证所示），而像与定制分类器一起使用的轻量级模型往往更新非常高效。在可解释性和可重复性方面，定制分类器也有优势。如果模型被弃用，商业 API 的结果可能不再可重复，并且如上所述，商业 GenAI 模型可能更像一个黑盒。这些担忧可以通过使用开源基础模型来缓解，例如 Meta AI 的 Llama (Touvron et al. 2023)。然而，启动成本和硬件要求抵消了易用性优势。最后，使用轻量级主干（如 RoBERTa (Liu et al. 2019)）的分类器在大量文本上部署成本非常低，而目前的商业模型对于大规模问题可能很昂贵。如果竞争加剧且廉价部署的研究取得进展，这种情况可能会改变。</span></p><p><span>要决定分类器还是生成式 AI 最适合某项任务，我建议首先进行粗略计算，以确保生成式 AI 在预算范围内。如果是，则创建测试集和验证集，调优提示，并评估其性能。如果性能不足，则需要训练集来调优定制分类器。如果用户事先知道保证可重复性是必须的，或者存在与网络文本的显著领域偏移，或者任务需要细粒度控制，他们可能会直接去训练一个定制分类器。对于处理机密数据的人来说，数据隐私要求可能需要额外考虑。</span></p><h3 id='73-序列分类'><span>7.3 序列分类</span></h3><p><span>经济学家可能希望在文本级别推算各种结构化信息：例如，其主题、包含的内容类型或其情感。为了说明文本序列分类，本节训练了 19 个不同的二元主题分类器，应用于大规模历史新闻数据库 (Dell et al. 2023; Silcock et al. 2024)，并将它们与生成式 AI 进行比较。让标注者记住 19 个不同的主题定义来创建多类标签会非常困难；因此，使用二元分类。二元分类器不能组合成多标签分类器，因为一个主题的阴性可能是另一个主题的阳性。为生成式 AI 保持提示简单也建议使用二元类别。</span></p><p><span>标注数据由高技能标注者进行一致性标注，差异通过手动解决。一致性标注确保了高质量数据，并促进了明确定义的发展。例如，在犯罪分类器的情况下，标注者对于关于水门事件的文章是否应被视为与主题相关存在分歧，而零样本模型显示 1974 年犯罪报道因水门事件而大幅激增。虽然这可能是一个合理的定义，但我不希望犯罪报道因政治丑闻（这些丑闻获得大量报道）而产生偏差，分类器通过少量标签很快就学会了这一点。</span></p><p><span>一个常见的问题是需要多少标签。这会有变化。更多样化或需要学习更复杂定义的主题将需要更多标签。在语言模型预训练中多次出现的主题可能需要更少的标签。幸运的是，训练分类器是计算高效的。如果在第一轮训练后结果不令人满意，可以很容易地添加更多标签并重新训练。错误分析可能会给出哪些类型的文本需要更多训练示例的感知。由于标注成本高，我建议从较少的标签开始，如果需要再添加更多。</span></p><p><span>表 2 提供了本节检查的各种主题分类任务的划分统计摘要。</span><sup class='md-footnote'><a href='#dfref-footnote-4' name='ref-footnote-4'>4</a></sup><span> 标注数据被随机划分为训练、验证和测试数据。验证数据用于选择超参数、选择模型检查点（何时停止训练）以及调优提示，而测试数据仅用于计算表 2。表 2 的提示列在附录（表 A1）中。</span></p><p><span>分类器使用 LinkTransformer 训练，它支持使用 Hugging Face 上可用的任何基础语言模型。我们使用了 DistilRoBERTa（8200 万参数）(Sanh et al. 2019b) 和 RoBERTa large（3.35 亿参数）。RoBERTa (Liu et al. 2019) 是一个广泛使用的、改进的 BERT 版本。蒸馏语言模型是较小的模型，训练以匹配较大模型的性能。蒸馏版本运行更快，但通常会有性能损失。我们在分类任务中使用了一致的超参数集，这些超参数似乎在更广泛的情况下效果良好（学习率为 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.082ex" height="1.692ex" role="img" focusable="false" viewBox="0 -666 2688.4 748" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-84-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-84-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-84-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-84-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-84-TEX-N-31"></use></g><g data-mml-node="mi" transform="translate(500,0)"><use data-c="1D452" xlink:href="#MJX-84-TEX-I-1D452"></use></g><g data-mml-node="mo" transform="translate(1188.2,0)"><use data-c="2212" xlink:href="#MJX-84-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2188.4,0)"><use data-c="36" xlink:href="#MJX-84-TEX-N-36"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mi>e</mi><mo>−</mo><mn>6</mn></math></mjx-assistive-mml></mjx-container><script type="math/tex">1e-6</script><span> 或 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.082ex" height="1.692ex" role="img" focusable="false" viewBox="0 -666 2688.4 748" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-85-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-85-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-85-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-85-TEX-N-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-85-TEX-N-31"></use></g><g data-mml-node="mi" transform="translate(500,0)"><use data-c="1D452" xlink:href="#MJX-85-TEX-I-1D452"></use></g><g data-mml-node="mo" transform="translate(1188.2,0)"><use data-c="2212" xlink:href="#MJX-85-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(2188.4,0)"><use data-c="35" xlink:href="#MJX-85-TEX-N-35"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mi>e</mi><mo>−</mo><mn>5</mn></math></mjx-assistive-mml></mjx-container><script type="math/tex">1e-5</script><span>，批大小为 8）。</span></p><p><span>在大多数情况下——跨越多样化的主题——调优的分类器往往优于或等于 GPT 的性能，但对于更简单的任务，GPT 的性能可以非常好，特别是在 GPT-4 的情况下。用于产生这些分类器的训练数据是高质量的。对于质量较低的标签，例如那些通过在线标注平台创建的标签（众所周知质量很差），定制训练的分类器很可能持续比 GPT 差。这些比较也可能随着开源和商业模型的进一步创新而改变。</span></p><p><span>更一般地说，生成式 AI 在简单主题上表现最好，这些主题很可能在预训练期间被广泛接触。领域与训练数据（主要是现代网络文本）的偏移越大，性能下降越多。对于占星术、讣告和关于脊髓灰质炎疫苗的文章——所有这些都极其简单——GPT 表现近乎完美（分类器也是如此）。然而，也有一些主题 GPT 表现不佳；例如，政治，这是一个具有挑战性的主题，因为它广泛且多样，内容来自十九世纪末和二十世纪初，包括地方和国家政治。第一次世界大战的 F1 分数在两个 GPT 模型中都在 70 分左右，比越南战争差得多，后者可能在训练语料库中有更大的代表性。此外，自第一次世界大战以来，语言变化更大，转化为更大的领域偏移。然而，通过最少的标签，RoBERTa 分类器可以适应这种领域偏移。</span></p><p><span>目前，对于大多数社会科学研究人员来说，GPT 对于大规模语料库可能超出预算，尽管我在这里没有引用具体数字，因为价格波动且可能因竞争和技术进步而发生相当大的变化。在所示数量的标签上训练 RoBERTa 分类器非常便宜（在撰写本文时，可以在每月 9.99 美元的 Google Colab 计划或中端 Nvidia GPU 卡上在几分钟内完成）。我也曾让学生们在笔记本电脑上耐心地训练类似的模型，尽管通过云计算或专用硬件访问一个像样的 GPU 更可取。部署分类器，即使跨越数百万篇文章，也很便宜，并且可以在云 CPU 或中端 GPU 卡上在几小时内完成。可以通过在 GPT 预测的标签上训练分类器来规避生成式 AI 的费用。表 2 显示，当 GPT 产生非常高质量的标签时，这可能有效。然而，在 GPT 表现较差的地方，在噪声数据上训练可能会放大错误。</span></p><p><span>图 4，取自 Silcock 等人 (2024)，采用了跨时间应用的二元分类器，并将其部署到 1878 年至 1977 年间发布的 270 万篇独特新闻专线文章的数据集中。各种趋势显而易见，例如 1920 年代与禁酒令相关的犯罪报道激增，或 1960 年代民权和抗议报道的激增。</span></p><p><span>值得谈谈神经方法与文本分类的稀疏方法相比如何，稀疏方法（具有不同程度的复杂性）依赖于关键词。例如，一种常见的稀疏方法是 TF–IDF：词频 (TF) 是文档 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.176ex" height="1.593ex" role="img" focusable="false" viewBox="0 -694 520 704" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-86-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-86-TEX-I-1D451"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">d</script><span> 中术语 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewBox="0 -626 361 637" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-88-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-88-TEX-I-1D461"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">t</script><span> 的原始计数。逆文档频率 (IDF) 衡量术语在整个语料库中的重要性。如果一个单词出现在许多文档中，它就不是给定文档的良好标识符。术语 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.817ex" height="1.441ex" role="img" focusable="false" viewBox="0 -626 361 637" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-88-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-88-TEX-I-1D461"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">t</script><span> 对于语料库 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.873ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 828 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-89-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-89-TEX-I-1D437"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">D</script><span> 的 IDF 由 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="26.672ex" height="2.817ex" role="img" focusable="false" viewBox="0 -892.5 11789.1 1245.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.798ex;"><defs><path id="MJX-90-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-90-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-90-TEX-N-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path><path id="MJX-90-TEX-N-2061" d=""></path><path id="MJX-90-TEX-N-54" d="M36 443Q37 448 46 558T55 671V677H666V671Q667 666 676 556T685 443V437H645V443Q645 445 642 478T631 544T610 593Q593 614 555 625Q534 630 478 630H451H443Q417 630 414 618Q413 616 413 339V63Q420 53 439 50T528 46H558V0H545L361 3Q186 1 177 0H164V46H194Q264 46 283 49T309 63V339V550Q309 620 304 625T271 630H244H224Q154 630 119 601Q101 585 93 554T81 486T76 443V437H36V443Z"></path><path id="MJX-90-TEX-N-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path><path id="MJX-90-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-90-TEX-N-20" d=""></path><path id="MJX-90-TEX-N-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-90-TEX-N-75" d="M383 58Q327 -10 256 -10H249Q124 -10 105 89Q104 96 103 226Q102 335 102 348T96 369Q86 385 36 385H25V408Q25 431 27 431L38 432Q48 433 67 434T105 436Q122 437 142 438T172 441T184 442H187V261Q188 77 190 64Q193 49 204 40Q224 26 264 26Q290 26 311 35T343 58T363 90T375 120T379 144Q379 145 379 161T380 201T380 248V315Q380 361 370 372T320 385H302V431Q304 431 378 436T457 442H464V264Q464 84 465 81Q468 61 479 55T524 46H542V0Q540 0 467 -5T390 -11H383V58Z"></path><path id="MJX-90-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-90-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path><path id="MJX-90-TEX-N-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path><path id="MJX-90-TEX-N-72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z"></path><path id="MJX-90-TEX-N-66" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z"></path><path id="MJX-90-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-90-TEX-N-63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path><path id="MJX-90-TEX-N-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path><path id="MJX-90-TEX-N-69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path><path id="MJX-90-TEX-N-A0" d=""></path><path id="MJX-90-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-90-TEX-N-4E" d="M42 46Q74 48 94 56T118 69T128 86V634H124Q114 637 52 637H25V683H232L235 680Q237 679 322 554T493 303L578 178V598Q572 608 568 613T544 627T492 637H475V683H483Q498 680 600 680Q706 680 715 683H724V637H707Q634 633 622 598L621 302V6L614 0H600Q585 0 582 3T481 150T282 443T171 605V345L172 86Q183 50 257 46H274V0H265Q250 3 150 3Q48 3 33 0H25V46H42Z"></path><path id="MJX-90-TEX-N-77" d="M90 368Q84 378 76 380T40 385H18V431H24L43 430Q62 430 84 429T116 428Q206 428 221 431H229V385H215Q177 383 177 368Q177 367 221 239L265 113L339 328L333 345Q323 374 316 379Q308 384 278 385H258V431H264Q270 428 348 428Q439 428 454 431H461V385H452Q404 385 404 369Q404 366 418 324T449 234T481 143L496 100L537 219Q579 341 579 347Q579 363 564 373T530 385H522V431H529Q541 428 624 428Q692 428 698 431H703V385H697Q696 385 691 385T682 384Q635 377 619 334L559 161Q546 124 528 71Q508 12 503 1T487 -11H479Q460 -11 456 -4Q455 -3 407 133L361 267Q359 263 266 -4Q261 -11 243 -11H238Q225 -11 220 -3L90 368Z"></path><path id="MJX-90-TEX-N-68" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 124T102 167T103 217T103 272T103 329Q103 366 103 407T103 482T102 542T102 586T102 603Q99 622 88 628T43 637H25V660Q25 683 27 683L37 684Q47 685 66 686T103 688Q120 689 140 690T170 693T181 694H184V367Q244 442 328 442Q451 442 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-90-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="6C" xlink:href="#MJX-90-TEX-N-6C"></use><use data-c="6F" xlink:href="#MJX-90-TEX-N-6F" transform="translate(278,0)"></use><use data-c="67" xlink:href="#MJX-90-TEX-N-67" transform="translate(778,0)"></use></g><g data-mml-node="mo" transform="translate(1278,0)"><use data-c="2061" xlink:href="#MJX-90-TEX-N-2061"></use></g><g data-mml-node="mfrac" transform="translate(1444.7,0)"><g data-mml-node="mrow" transform="translate(1163.6,394) scale(0.707)"><g data-mml-node="mtext"><use data-c="54" xlink:href="#MJX-90-TEX-N-54"></use><use data-c="6F" xlink:href="#MJX-90-TEX-N-6F" transform="translate(722,0)"></use><use data-c="74" xlink:href="#MJX-90-TEX-N-74" transform="translate(1222,0)"></use><use data-c="61" xlink:href="#MJX-90-TEX-N-61" transform="translate(1611,0)"></use><use data-c="6C" xlink:href="#MJX-90-TEX-N-6C" transform="translate(2111,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(2389,0)"></use><use data-c="6E" xlink:href="#MJX-90-TEX-N-6E" transform="translate(2639,0)"></use><use data-c="75" xlink:href="#MJX-90-TEX-N-75" transform="translate(3195,0)"></use><use data-c="6D" xlink:href="#MJX-90-TEX-N-6D" transform="translate(3751,0)"></use><use data-c="62" xlink:href="#MJX-90-TEX-N-62" transform="translate(4584,0)"></use><use data-c="65" xlink:href="#MJX-90-TEX-N-65" transform="translate(5140,0)"></use><use data-c="72" xlink:href="#MJX-90-TEX-N-72" transform="translate(5584,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(5976,0)"></use><use data-c="6F" xlink:href="#MJX-90-TEX-N-6F" transform="translate(6226,0)"></use><use data-c="66" xlink:href="#MJX-90-TEX-N-66" transform="translate(6726,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(7032,0)"></use><use data-c="64" xlink:href="#MJX-90-TEX-N-64" transform="translate(7282,0)"></use><use data-c="6F" xlink:href="#MJX-90-TEX-N-6F" transform="translate(7838,0)"></use><use data-c="63" xlink:href="#MJX-90-TEX-N-63" transform="translate(8338,0)"></use><use data-c="73" xlink:href="#MJX-90-TEX-N-73" transform="translate(8782,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(9176,0)"></use><use data-c="69" xlink:href="#MJX-90-TEX-N-69" transform="translate(9426,0)"></use><use data-c="6E" xlink:href="#MJX-90-TEX-N-6E" transform="translate(9704,0)"></use><use data-c="A0" xlink:href="#MJX-90-TEX-N-A0" transform="translate(10260,0)"></use></g><g data-mml-node="mi" transform="translate(10510,0)"><use data-c="1D437" xlink:href="#MJX-90-TEX-I-1D437"></use></g></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mtext"><use data-c="4E" xlink:href="#MJX-90-TEX-N-4E"></use><use data-c="75" xlink:href="#MJX-90-TEX-N-75" transform="translate(750,0)"></use><use data-c="6D" xlink:href="#MJX-90-TEX-N-6D" transform="translate(1306,0)"></use><use data-c="62" xlink:href="#MJX-90-TEX-N-62" transform="translate(2139,0)"></use><use data-c="65" xlink:href="#MJX-90-TEX-N-65" transform="translate(2695,0)"></use><use data-c="72" xlink:href="#MJX-90-TEX-N-72" transform="translate(3139,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(3531,0)"></use><use data-c="6F" xlink:href="#MJX-90-TEX-N-6F" transform="translate(3781,0)"></use><use data-c="66" xlink:href="#MJX-90-TEX-N-66" transform="translate(4281,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(4587,0)"></use><use data-c="64" xlink:href="#MJX-90-TEX-N-64" transform="translate(4837,0)"></use><use data-c="6F" xlink:href="#MJX-90-TEX-N-6F" transform="translate(5393,0)"></use><use data-c="63" xlink:href="#MJX-90-TEX-N-63" transform="translate(5893,0)"></use><use data-c="73" xlink:href="#MJX-90-TEX-N-73" transform="translate(6337,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(6731,0)"></use><use data-c="77" xlink:href="#MJX-90-TEX-N-77" transform="translate(6981,0)"></use><use data-c="69" xlink:href="#MJX-90-TEX-N-69" transform="translate(7703,0)"></use><use data-c="74" xlink:href="#MJX-90-TEX-N-74" transform="translate(7981,0)"></use><use data-c="68" xlink:href="#MJX-90-TEX-N-68" transform="translate(8370,0)"></use><use data-c="20" xlink:href="#MJX-90-TEX-N-20" transform="translate(8926,0)"></use><use data-c="74" xlink:href="#MJX-90-TEX-N-74" transform="translate(9176,0)"></use><use data-c="65" xlink:href="#MJX-90-TEX-N-65" transform="translate(9565,0)"></use><use data-c="72" xlink:href="#MJX-90-TEX-N-72" transform="translate(10009,0)"></use><use data-c="6D" xlink:href="#MJX-90-TEX-N-6D" transform="translate(10401,0)"></use><use data-c="A0" xlink:href="#MJX-90-TEX-N-A0" transform="translate(11234,0)"></use></g><g data-mml-node="mi" transform="translate(11484,0)"><use data-c="1D461" xlink:href="#MJX-90-TEX-I-1D461"></use></g><g data-mml-node="mtext" transform="translate(11845,0)"><use data-c="A0" xlink:href="#MJX-90-TEX-N-A0"></use><use data-c="69" xlink:href="#MJX-90-TEX-N-69" transform="translate(250,0)"></use><use data-c="6E" xlink:href="#MJX-90-TEX-N-6E" transform="translate(528,0)"></use><use data-c="A0" xlink:href="#MJX-90-TEX-N-A0" transform="translate(1084,0)"></use></g><g data-mml-node="mi" transform="translate(13179,0)"><use data-c="1D437" xlink:href="#MJX-90-TEX-I-1D437"></use></g></g><rect width="10104.4" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mfrac><mrow><mtext>Total number of docs in&nbsp;</mtext><mi>D</mi></mrow><mrow><mtext>Number of docs with term&nbsp;</mtext><mi>t</mi><mtext>&nbsp;in&nbsp;</mtext><mi>D</mi></mrow></mfrac></math></mjx-assistive-mml></mjx-container><script type="math/tex">\log \frac{\text{Total number of docs in } D}{\text{Number of docs with term } t \text{ in } D}</script><span> 给出。术语的 TF–IDF 分数就是其 TF 和 IDF 分数的乘积。TF–IDF 分数越高，术语相对于整个语料库的上下文对特定文档越重要。要使用 TF–IDF 根据语料库中文档与查询的相似性对文档进行排名，每个文档和查询都表示为一个稀疏的高维向量，每个维度对应于语料库中的一个唯一术语。向量中每个术语的权重是其 TF–IDF 分数。任何两个向量之间的夹角捕捉了文本之间的相似性。可以将其视为类似于关键词搜索，但会降低在整个语料库中出现的术语的权重。</span></p><p><span>我们将像 TF-IDF 这样的方法称为稀疏的，因为语料库中的每个术语构成向量空间中的一个维度。词汇表中的大多数术语不会出现在单个文档中，导致术语向量中的大多数条目为零。</span></p><p><span>稀疏方法在精确术语重叠信息量很大时很有用。然而，依赖术语重叠通常是一个主要缺点，因为语言是复杂的。表达同一件事的方式有很多种，同一个术语可能有不同的含义。此外，噪声（例如，拼写错误、OCR 错误、缩写）无处不在。语义随时间和空间变化，许多遗漏变量也是如此。这可能导致预测误差与使用关键词预测的因果估计方程中的误差项相关。此外，虽然术语可以被挖掘，但更常见的是它们被简单地选择，这造成了研究人员的自由度问题。</span></p><p><span>神经方法通过使用大型语言模型将文本映射到密集向量表示来解决这些缺点，例如，一个由非零项组成的 768 维向量。这个向量的维度取决于基础语言模型。预训练的语言模型被赋予了语言理解能力，因此密集方法考虑了上下文和语义相似性。这使得它们能够泛化到同义词和语义相似的短语，并对其他噪声更鲁棒。</span></p><p><span>Dell 等人 (2023) 比较了上述政治神经分类器与挖掘的关键词以及 ChatGPT 建议的关键词。神经方法导致显著更准确的预测。</span></p><h3 id='74-词元分类'><span>7.4 词元分类</span></h3><p><span>研究人员可能需要提取关于文本中单个术语的信息，而不是整个文本。这个问题类似于序列分类，只是分类器头被添加到 Transformer 最后一层中每个词元的表示，而不仅仅是 </span><code>&lt;cls&gt;</code><span> 表示（图 3，面板 C）。</span></p><p><span>本节开发了一个词元分类的示例，命名实体识别 (NER)，它检测文本中的命名实体。这些实体可以按照研究人员的意愿定义，只要存在清晰、一致的定义和足够的训练标签。例如，研究人员可能希望识别社交媒体帖子中提及的地点。或者，希望从讣告数据中提取家庭关系的研究人员可能希望标记个人与逝者的关系（孩子、父母、兄弟姐妹、司仪等）。或者，希望将传记文本转换为结构化数据集的研究人员可能标记出生地、母亲、父亲、大学、配偶和雇主。</span></p><p><span>NER 是一项经典任务，产生了非常庞大的文献，并且在 Hugging Face 上有许多开源预训练模型和数据集。在该文献中，实体类别通常包括人物、地点和组织。CoNLL 是一个突出的基准 (Sang and De Meulder 2003)，用于在 Hugging Face 上预训练各种模型。WNUT 是另一个 (Nguyen et al. 2020)，侧重于嘈杂的用户生成文本（推文）。</span><sup class='md-footnote'><a href='#dfref-footnote-5' name='ref-footnote-5'>5</a></sup><span> 如果研究人员偏离基准所强调的实体类型，他们将需要创建标签。NER 通常使用 BIO 标注——实体中的第一个词元标记为 B（表示开始），随后的词元标记为 I（表示内部），不感兴趣的词元标记为 O。如果感兴趣的实体类型是人物 (P) 和地点 (L)，标签将是 B-P、B-L、I-P、I-L 和 O。</span></p><p><span>图 5 展示了将 NER 应用于历史新闻专线文章的结果，绘制了超过 2700 万个实体中属于四个类别的比例：人物、地点、组织和杂项。结果是合理的，例如显示在第二次世界大战期间地点和杂项命名实体（例如，飞机名称）的激增。</span></p><p><span>也可以要求生成式 AI 识别文本中的实体并将输出转换为表格。与序列分类一样，研究人员可以通过构建有代表性的验证集和测试集来测试性能是否满足其需求。</span></p><h3 id='75-文本之间的关系'><span>7.5 文本之间的关系</span></h3><p><span>在各种情况下，我们希望衡量两个文本是否以某种预先指定的方式相关。例如，我们可以将主题分类框架为一项任务，我们希望分类一个陈述是否蕴含另一个陈述：文章文本是否蕴含陈述“这篇文章是关于货币政策的”？或者，两个文本是否是彼此的噪声重复副本？它们是否对政治问题持相同立场？一个是否跟随另一个？</span></p><p><span>图 6 说明了两种比较文本的方法。顶部显示了一个交叉编码器：两个文本被连接起来，中间有一个 </span><code>&lt;sep&gt;</code><span> 词元。这些文本被联合输入 Transformer，一个分类器头对它们的关系进行分类。这种方法允许每个文本中的所有词元之间进行完全的交叉注意力。底部图展示了一个双编码器方法：文本被单独嵌入，然后我们使用某种距离度量（如余弦相似度）计算它们之间的相似度。双编码器非常有用，我们将在第 8 节详细阐述。</span></p><p><span>交叉编码器允许术语之间的完全交叉注意力。由于它们是联合嵌入的，被比较的文本中的术语在创建表示时灵活地相互关注。相比之下，双编码器为每个文本单独计算一个表示，然后比较这些表示。因此，交叉编码器往往具有更高的准确性。然而，它们也有显著的缺点。最核心的是，如果我们需要比较 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.378ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 1051 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-94-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-94-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">M</script><span> 个文本与 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-95-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-95-TEX-I-1D441"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">N</script><span> 个其他文本，这将需要嵌入 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.153ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 3161.4 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-93-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-93-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-93-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-93-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(1273.2,0)"><use data-c="D7" xlink:href="#MJX-93-TEX-N-D7"></use></g><g data-mml-node="mi" transform="translate(2273.4,0)"><use data-c="1D441" xlink:href="#MJX-93-TEX-I-1D441"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo>×</mo><mi>N</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">M \times N</script><span> 个文本。这种二次成本很快变得不可行，因为每个文本都要通过一个具有数亿参数的神经网络。</span><sup class='md-footnote'><a href='#dfref-footnote-6' name='ref-footnote-6'>6</a></sup><span> 相比之下，对于双编码器比较 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.378ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 1051 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-94-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-94-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">M</script><span> 个文本与 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-95-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-95-TEX-I-1D441"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">N</script><span> 个其他文本，只需要 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.153ex" height="1.731ex" role="img" focusable="false" viewBox="0 -683 3161.4 765" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-96-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-96-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-96-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-96-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(1273.2,0)"><use data-c="2B" xlink:href="#MJX-96-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(2273.4,0)"><use data-c="1D441" xlink:href="#MJX-96-TEX-I-1D441"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo>+</mo><mi>N</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">M + N</script><span> 个嵌入，使这种方法具有高度可扩展性。为了两全其美，文献通常使用双编码器来获取与查询文本最相似的 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-98-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-98-TEX-I-1D45B"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">n</script><span> 个文本（对于某个小的 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-98-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-98-TEX-I-1D45B"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">n</script><span>），然后用交叉编码器对这些匹配进行重新排序。</span></p><h2 id='8-嵌入模型'><span>8. 嵌入模型</span></h2><p><span>要估计一个分类器，类别必须事先指定，因为类别的数量决定了神经网络中的参数数量，并且类别必须在训练中被看到。提示生成式 AI 进行分类任务也需要指定感兴趣的类别。然而，存在各种类别事先未知或研究人员希望稍后添加新类别而无需重新训练模型的问题。此外，如果类别数量很大，计算损失函数在所有类别上的 softmax 可能在计算上变得不可行。</span></p><p><span>这些常见场景可以通过直接处理 Transformer 或 CNN 最后一层的嵌入来解决，而不是估计一个额外的神经网络层（分类器）将嵌入映射到类别分数。这避免了类别的预先指定。此外，向量相似性计算是高度优化的，允许处理数百万甚至数十亿类别规模的问题。</span></p><p><span>本节介绍各种可以用嵌入模型处理的应用。记录链接（例如，跨数据集的个人、公司、地点或产品）是一项常见任务，可以框架为具有许多类别（例如，每个个人、公司等）的分类问题。它特别适合嵌入方法（第 8.2 节）。这些方法可以处理传统字符串匹配方法难以应对的场景——如多语言链接或具有多个噪声文本描述的链接。类似的方法可用于将非结构化文本（例如，社交或印刷媒体、公司文件、传记、政府文件）中提及的个人、公司等链接到外部知识库（如 Wikipedia）（第 8.3 节）。追踪文本或图像在媒体中的传播是另一个潜在感兴趣的应用，其中类别通常事先未知（第 8.4 节）。在某些情况下，目的可能是探索性的，以揭示海量新颖文本或图像数据集中的典型事实，嵌入方法非常适合此类描述性分析。最后，光学字符识别 (OCR) 可以框架为图像分类任务，研究人员可能希望随后添加字符或单词而无需重新训练模型，这表明嵌入方法（第 8.5 节）。</span></p><p><span>直接处理嵌入要求向量表示之间的距离有意义。预训练 Transformer 语言模型的几何特性并不非常适合这项任务。例如，低频词的表示被向外推到了超球面上。低频词的稀疏性违反了凸性，并且嵌入之间的距离与词汇相似性相关。这导致语义相似文本的嵌入之间对齐不良，并且在汇集单个术语表示以创建文本序列的平均表示时性能不佳 (Ethayarajh 2019; Reimers and Gurevych 2019)。</span></p><p><span>从数学上讲，问题在于预训练 Transformer 模型创建的嵌入空间不是各向同性的，这意味着表示不是均匀分布的。当嵌入是各向同性时，没有特定的方向被偏爱。这种均匀分布确保向量之间的距离准确反映它们的关系，使空间对于依赖这些距离的任务更有效。对比学习是一种广泛使用的方法，可以改善各向同性，在转向嵌入模型应用之前进行讨论。</span></p><h3 id='81-对比学习'><span>8.1 对比学习</span></h3><p><span>对比学习旨在为语义相似的输入学习相似的表示，为语义不同的输入学习不同的表示，其中相似性的定义由经验训练示例给出。对比损失函数鼓励模型减少嵌入空间中正例（例如，相似文本或图像）之间的距离，并增加负例（例如，不相似文本或图像）之间的距离。对比训练减少了各向异性 (Wang and Liu 2021)，显著改善了文本序列的汇集表示 (Reimers and Gurevych 2019)，并改善了语义相似文本表示之间的对齐。</span></p><p><span>对比学习遵循图 6 所示的双编码器设置。双编码器通过将每个实例通过 Transformer 并汇集（平均）词元级嵌入，为每个实例形成一个单一表示。</span><sup class='md-footnote'><a href='#dfref-footnote-7' name='ref-footnote-7'>7</a></sup><span> 可以通过计算它们的向量相似性来比较表示。在实践中经常使用余弦相似度，因为表示在单位超球面上。</span></p><p><span>根据训练数据，损失函数有不同的选择。对比损失 (Chopra, Hadsell, and LeCun 2005) 使用正负对，激励正例具有相同的表示，负例之间的距离超过阈值。余弦损失使用实例之间差异的连续度量。对于三元组损失 (Hermans, Beyer, and Leibe 2017)，训练数据由三元组组成：一个锚点、一个锚点的正例和一个负例。正例的嵌入被激励比负例更类似于锚点。对于 InfoNCE 损失 (Oord, Li, and Vinyals 2018)，将多个负例与单个正例进行比较。监督对比损失 (Khosla et al. 2020) 将 InfoNCE 推广到允许多个正例和负例。更多细节，包括数学公式，在 EconDL 知识库的“对比学习”帖子中提供。</span></p><p><span>神经网络创建的度量空间应根据用于训练网络的对比损失函数来解释。例如，对于对比损失，同一类别的实例被激励具有相似的表示，而不同的实例被激励超过阈值距离。因此，局部距离是有意义的，但全局距离不是，因为超出阈值的更不相似性不影响损失。</span></p><p><span>当在配对数据上进行对比训练时，用于嵌入每个实例的两个编码器的权重可以相同（对称编码器）或不同（非对称编码器，如 Karpukhin 等人 2020）。对称编码器提供了一个更简约的模型，因此需要更少的数据和计算来训练。在实践中，即使编码两种不同类型的实例（例如，搜索查询和包含其答案的文档），它们也能表现良好。</span></p><p><span>选择信息丰富的负例对于对比学习很重要。如果负例太“容易”——例如，它们在用于初始化训练的预训练模型的嵌入空间中不相似——那么学到的东西很少。在某些情况下，研究人员可以使用先验知识来选择“困难”的负例进行训练。在其他情况下，可以通过使用预训练模型选择具有相似嵌入的负例来挖掘它们。如果研究人员事先知道哪些实例是负例，这可以很好地工作，就像在合成生成的数据上训练时那样。然而，当负例从未标注数据中抽取时，在没有人工参与的情况下挖掘困难负例，可能会无意中选择正例。有时在随机负例上训练可能就足够了，尽管这通常需要大批量大小（例如，具有大量内存的 GPU 卡），这不适合学术计算预算。本节的应用考虑了如何选择负例。</span></p><p><span>嵌入也有现成的可用。Sentence-BERT (Reimers and Gurevych 2019) 是一个突出且得到良好支持的开源模型。（在该文献中，术语“句子”用于指代任何文本序列，可以是一个短语、句子或整个文档。）此外，OpenAI 销售相当实惠的句子嵌入。</span></p><p><span>尽管开发能够在任何任务上零样本表现出色的通用嵌入模型引起了相当大的兴趣 (Cao 2024)——并且更大的模型在零样本上平均会优于更小的模型——但微调的轻量级嵌入模型相对于零样本嵌入具有重要的优势。直观地说，嵌入为每个文本（或图像）提供了一个单一的表示。现成的表示将捕获关于文本/图像的许多不同信息。然而，研究人员通常只对其某些狭义定义的方面感兴趣。微调将增强相关维度，在嵌入空间中创建更好的类别分离。</span></p><p><span>考虑以下实证示例。我使用美国立法的比较议程数据集 (Wilkerson et al. 2023)，该数据集为国会法案分配主题标签，并使用三种不同的模型计算立法描述嵌入之间的成对相似度：现成的轻量级 S-BERT 嵌入（图 7，面板 A）、OpenAI 大型嵌入（面板 B）以及通过在这些数据的训练划分上对 S-BERT 在配对正例和（随机）负例法案上进行微调产生的嵌入（面板 C）。蓝色分布绘制了主题内的余弦相似度，红线绘制了主题间的余弦相似度。相同的表示相似度为 1。</span></p><p><span>对于现成模型，嵌入确实在主题内比主题间更相似（例如，蓝色分布位于红色分布的右侧），但差异并不显著。S-BERT 和 OpenAI 表现相似。相比之下，一旦模型在目标数据上进行了微调，嵌入在主题内比主题间相似得多，因为对比训练增强了主题在决定语言模型如何将文本映射到嵌入空间中的重要性。分布中的大部分重叠来自边缘情况，即文章落在主题之间或涵盖多个主题。面板 D 使用在美国法案上微调的模型来比较英国议会法案在主题内和主题间的嵌入。虽然存在一些领域偏移，但仍有明显的分离，显示了微调模型在泛化到类似问题上的能力。</span></p><h3 id='82-结构化数据的记录链接'><span>8.2 结构化数据的记录链接</span></h3><p><span>记录链接是许多经济分析的核心。研究人员可能需要跨数据集链接个人、地点、公司、组织、产品描述或学术论文。传统上，记录使用诸如 Levenshtein 编辑距离（计算将一个字符串转换为另一个字符串所需的字符插入、删除和替换次数）或 Jaccard 相似度（计算字符串的子串 n-gram 表示之间的相似性）等度量进行链接。最近专注于跨电子商务数据集匹配的机器学习文献显示了 Transformer LLMs 在改进记录链接方面的前景。然而，在撰写本文时，这些方法尚未在社会科学中广泛普及，基于规则的方法继续占绝对主导地位（例如，参见 Binette and Steorts 2022; Abramitzky et al. 2021; Bailey et al. 2020 的综述）。</span></p><p><span>为了使这些方法更易于使用，Arora and Dell (2024) 设计了 LinkTransformer，这是一个用于使用 Transformer 模型进行记录链接的软件包，面向社会科学家。该研究记录了 Transformer 在各种任务和语言上优于传统字符串匹配方法，通常优势明显。应用包括链接 1940 年墨西哥关税表和链接 1950 年日本公司层面记录（使用多个噪声字段），以及跨六种语言链接现代公司和产品。多语言模型可以跨语言链接产品，无需翻译。</span></p><p><span>这项工作的动机是我在深度学习时代之前不得不放弃的各种项目，因为稀疏方法表现不佳，手动链接不可行。与任何预测任务一样，研究人员有责任使用测试集评估性能是否可接受。</span></p><p><span>LinkTransformer 模型架构如图 8 所示。需要匹配的文本使用 Transformer 语言模型进行编码。对于每个查询，LinkTransformer 在语料库中查找最近邻，通过嵌入之间的余弦相似度来衡量。这非常快，因为它使用了高度优化的 Facebook 人工智能相似性搜索 (FAISS) 后端 (Johnson, Douze, and Jégou 2021)。LinkTransformer 返回一个排名以及余弦相似度分数，这些可以用于一对一、一对多或多对多合并，包括无匹配（当与最近记录的相似度低于某个阈值时捕获）。</span></p><p><span>正如传统的稀疏方法（如编辑距离）返回记录之间的距离一样，LinkTransformer 计算一个由预训练语言模型中体现的所有语义知识以及通过对比训练获得的任何额外知识驱动的距离度量。例如，ABC Corporation、ABC Co. 和 ABCC 在语义上非常相似——因此在嵌入空间中相近——因为“Co.”和“C”代表“Corporation”，但这些字符串具有很高的 Levenshtein 编辑距离。像这样的例子在记录链接任务中很常见，考虑到缩写、描述同一产品或公司名称的不同方式、OCR 错误和拼写错误的普遍存在。嵌入相似度可以类似于研究人员使用字符串距离度量的方式使用。</span></p><p><span>LinkTransformer 无缝支持多字段链接，通过使用软件包自动选择的与基础语言模型分词器兼容的 </span><code>&lt;sep&gt;</code><span> 词元连接字段来序列化字段。该研究提供了一个示例，使用公司名称、地点、产品、股东和银行链接 1950 年代日本公司跨不同的大规模、噪声数据库。这种类型的链接问题使用字符串匹配方法会非常复杂，因为字段是噪声的（例如，产品在不同数据集中以不同方式描述，列出了不同子集的管理者和股东等）。大型语言模型可以轻松处理这些挑战，因为它捕捉语义相似性。</span></p><p><span>LinkTransformer 允许用户使用 Sentence Transformer 模型、OpenAI 嵌入、在目标任务上微调的模型或 Hugging Face 上可用的任何 Transformer 语言模型。在 20 个不同的链接任务中出现的总体情况是，在少量标签上定制训练的模型往往表现最好，其次是现成的 OpenAI 嵌入，然后是现成的 Sentence Transformer 模型（尽管任务之间有一些变化）。结果与上述关于现成与定制嵌入模型的讨论一致。</span></p><p><span>LinkTransformer 还提供 API 以使用 Transformer 大语言模型进行其他数据处理任务，例如分类、聚合和去重，如 EconDL 链接的教程笔记本中所述。用户还可以找到“训练您自己的 LinkTransformer 模型”教程，用于需要定制的情况。对比训练需要正负对（在这种情况下，链接的记录和不同的记录）。用户可以仅提供正例——在这种情况下，LinkTransformer 随机选择负例——或者可以提供正例和负例，如果有困难负例可用。为了促进可重用性、可重复性和可扩展性，模型可以通过一行代码共享到 Hugging Face hub。</span></p><p><span>当任务是链接扫描文档时（如经济史中的许多情况），计算机视觉也可能有用。在 Arora, Yang 等人 (2024) 开发的纯视觉记录链接模型中，记录链接是无 OCR 的，仅使用要链接的公司名称的图像裁剪。这在具有挑战性的环境中进行了探索，链接历史日本出版物之间的公司，其中一个出版物是横向书写的，另一个是纵向书写的。总的来说，纯视觉链接导致相当高的准确性。然而，有一些匹配是视觉模型无法解决的，因为公司可以以不同的方式书写其名称。</span></p><p><span>嵌入模型可以结合视觉和语言 Transformer，利用对语义和视觉相似性的理解。Arora, Yang 等人 (2024) 表明，多模态模型导致对 OCR 化的日本公司层面客户和供应商记录的极其准确的链接，而准确性较低的字符串距离度量产生不同的供应链网络，这可能导致有偏的下游经济分析。</span></p><p><span>结合文本和图像嵌入在嵌入空间对齐时最为直接。换句话说，同一事物的图像和文本表示需要具有相似的嵌入；例如，鳄梨的图片和文本“鳄梨”在图像和文本编码器分别将它们映射到向量空间时具有相似的嵌入。Arora, Yang 等人 (2024) 从日语版本的 CLIP 开始，CLIP 代表对比语言-图像预训练。CLIP 是一个 OpenAI 模型，通过对比训练使用从网络上抓取的 4 亿个图像-标题对来对齐文本和图像编码器 (Radford et al. 2021)。Arora, Yang 等人 (2024) 在合成噪声的文档裁剪及其相应 OCR 化文本对上进行了进一步的预训练。然后使用汇集的文本-图像表示来链接公司。</span></p><p><span>还有其他方法可以将视觉相似性纳入链接，当存在 OCR 错误时可能会有帮助。近似字符串匹配方法计算将一个字符串转换为另一个字符串所需的编辑（插入、删除和替换）次数 (Levenshtein 1966)。在实践中，并非所有字符串替换都是同等可能的，调整其成本的列表构建工作至少可以追溯到 1918 年，当时 Russell 和 Odell 为 Soundex 申请了专利 (Russell 1918; National Archives and Records Administration 2023)，这是一个声音标准化工具包，考虑了人口普查员经常根据发音拼错名字的事实。此类方法可以显著提高编辑距离链接在为其量身定制的上下文中的准确性，但由于使用手工设计的特征，扩展到新设置需要大量劳动。这导致使用链接数据的研究——这对于检验许多经济问题是必要的——偏向于不能代表人类社会多样性的高资源环境。</span></p><p><span>Yang 等人 (2023) 开发了一种可扩展的自监督方法，用于确定在 OCR 创建的数据库中字符替换的相对成本。OCR 经常混淆字符与其同形异义词，这些字符具有相似的视觉外观（例如，“0”和“O”）。Yang 等人 (2023) 通过增强数字字体来对比学习一个度量空间，其中同一字符的不同增强（例如，用不同字体渲染的同一字符）具有相似的向量表示。得到的空间可以与参考字体一起使用，以测量不同字符之间的视觉相似度。字符及其在同形异义词空间中的最近邻示例如图 9 所示。</span></p><p><span>使用同形异义词空间中字符之间的余弦距离作为 Levenshtein 编辑距离框架 (Levenshtein 1966) 内的替换成本，显著改善了公司和地名的链接。该研究侧重于 CJK，因为该文字中字符数量极大，完全不可能手动计算同形异义词，但表明该方法可通过计算古汉字和所有 Unicode 字符的同形异义词来扩展。更广泛的启示是，即使传统方法——如字符串距离——更受青睐，深度学习也可能提供一种廉价地将方法扩展到新颖设置的方式。</span></p><h3 id='83-链接非结构化数据'><span>8.3 链接非结构化数据</span></h3><p><span>也有大量关于链接非结构化文本（例如，新闻、社交媒体等）中实体的 NLP 文献，这项任务被称为实体消歧。将原始文本中的实体提及（通过 NER 标记——第 7.4 节）链接到 Wikipedia 或其他知识库是有用的，因为这些知识库包含诸如结构化传记数据等信息。个人是否在外部知识库中本身也可能令人感兴趣。</span></p><p><span>研究人员可能还希望在一个语料库的文档之间进行实体提及的共指解析（例如，查找历史新闻中所有对 John F. Kennedy 总统的提及）。这被称为共指消解。</span></p><p><span>尽管数字化程度不断提高，历史文档通常缺乏文本中提及个人的跨文档标识符，以及来自外部知识库（如 Wikipedia）的标识符，这两者都将使经济学家更容易从这些来源提取结构化数据。</span></p><p><span>Arora, Silcock 等人 (2024) 开发了一个用于在文本内共指实体并将其消歧到 Wikipedia 的双编码器嵌入模型。该模型在来自 Wikipedia 的超过 1.9 亿个实体对上进行了对比训练。正例来自 Wikipedia 中包含指向同一页面超链接的上下文（段落）（用于共指）或来自上下文及其链接到的相关实体的第一段（用于消歧）。困难负例是从 Wikipedia 消歧页面大规模挖掘的，这些页面列出了具有易混淆名称或别名的实体。例如，消歧页面“John Kennedy”包括 John F. Kennedy 总统、John Kennedy（路易斯安那州政治家）、John F. Kennedy Jr. 以及各种其他 John Kennedys。困难负例抽样提及 John F. Kennedy 的上下文（例如，带有指向 John F. Kennedy 页面的超链接），并将它们与提及来自 John Kennedy 消歧页面的其他实体的上下文配对。通过从 Wikidata 挖掘家庭成员，来自家庭的困难负例（例如，Henry Ford Jr. 和 Sr.）被过度代表。还需要包括随机负例，否则模型会失去其区分简单情况的初始能力，这种现象在深度学习文献中被称为灾难性遗忘。</span></p><p><span>这说明了如何挖掘现有知识来为对比训练创建信息丰富的负例。更一般地说，Wikipedia 是一个有用的训练数据来源（例如，用于训练 LinkTransformer 模型的公司别名也取自 Wikidata）。</span></p><p><span>实体提及通过使用消歧模型嵌入其上下文，并在嵌入空间中检索其最近的 Wikipedia 邻居来进行消歧。如果它们与最近的 Wikipedia 嵌入的余弦相似度低于阈值，则被标记为不在知识库中。Silcock 等人 (2024) 发现，这 100 年中提及最多的实体是 Dwight Eisenhower——略高于 Adolf Hitler、Richard Nixon 和 Harry Truman——并且新闻专线文章中消歧的实体中只有 4.7% 是女性。</span></p><h3 id='84-类别未知时的分类'><span>8.4 类别未知时的分类</span></h3><p><span>研究人员希望从非结构化数据中推算的类别可能事先未知。这在目的是描述新颖非结构化语料库中的典型事实时尤其可能，但也可以更一般地出现。本节提供了几个来自媒体经济学的例子：检测复制的文章文本和图像、分类历史上最大的新闻故事，以及检索与现代新闻文章语义相似的历史新闻故事。</span></p><p><span>复制内容是媒体的一个基本特征——无论是传统媒体还是在通过社交媒体分享的时代。媒体历史学家 Julia Guarneri (2017) 写道：“到 1910 年代和 1920 年代，美国人阅读的大部分本地报纸文章要么是在全国新闻市场上购买的，要么是出售的……这构建了一种被广泛理解的美国‘生活方式’，这将成为整个二十世纪美国国内政治和国际关系的试金石。”假设我们希望能够识别通过新闻专线发送的每一篇独特文章和图像，衡量其被复制的广泛程度，并观察哪些报纸复制了它。这个问题比看起来更具挑战性。文本经常被大量删节，并且可能包含显著的 OCR 错误。图像经常被裁剪，质量可能极低。</span></p><p><span>Silcock 等人 (2022) 表明，深度神经方法在检测噪声重复文本方面显著优于非神经方法，应用于历史新闻专线、现代新闻和专利数据库。训练和评估数据通过将数千份数字化本地报纸中的文章分组到来自同一新闻专线来源的文章组中进行手动整理。来自同一专线来源的文章是正例。具有高 n-gram 重叠但来自不同来源的文章——通常来自不同新闻专线服务的相似文章或文章更新——形成困难负例。随机负例也用于训练。</span></p><p><span>一个双编码器嵌入模型经过对比训练，使得来自同一专线文章来源的文章（无论噪声和删节如何）具有相似的向量表示，而来自不同来源的文章（即使关于同一底层故事）具有不同的表示。然后可以使用高效的单链接聚类对这些表示进行聚类，以量化哪些文章来自同一底层新闻专线或辛迪加文章来源，哪些来自不同的来源。社区检测用于打破单链接聚类可能带来的虚假链接。</span><sup class='md-footnote'><a href='#dfref-footnote-8' name='ref-footnote-8'>8</a></sup><span> 与记录链接一样，Sentence-BERT 库 (Reimers and Gurevych 2019) 是一个重要资源。该模型使用 S-BERT MPNet 双编码器初始化，这是一个轻量级、高性能的语义相似性模型。</span></p><p><span>神经方法大大优于传统的 N-gram 和哈希方法——这些稀疏方法依赖术语重叠来检测噪声重复副本。如第 7.5 节所建议，通过添加一个重新排序步骤，将交叉编码器应用于双编码器距离阈值内的文章，可以获得适度的收益。</span></p><p><span>嵌入方法的一个优势是其可扩展性。对密集向量表示进行聚类需要高度优化的相似性搜索，因为传统的聚类库不能很好地扩展。FAISS (Johnson, Douze, and Jégou 2021)，一个用于计算向量相似性的开源库，在大约 3 小时内在单个 GPU 卡上完成了 10^14 次精确相似性比较——这是聚类 1000 万篇文章表示所需的。通过使用近似向量搜索（具有适当调优的超参数），可以显著加快速度，而准确性只有适度的损失。</span></p><p><span>Silcock 等人 (2024) 发布了 1878 年至 1977 年间的 270 万篇独特新闻专线文章（结束日期是由于版权法变更）。它包括主题标签、命名实体标签、个人到 Wikipedia 的消歧，以及文章出现的县。</span></p><p><span>检测图像的噪声复制类似于检测复制的文本。不是训练语言模型，而是可以对比训练一个视觉模型，将同一图像的复制版本映射到相似的向量表示，将不同的图像映射到不相似的表示。在实践中，轻量级 CNN 效果很好 (Howard et al. 2019)，使用更大的 ViT 几乎没有增益。训练数据主要由合成增强的图像组成，这些图像模拟了实际图像中存在的噪声。当可以模拟现实的合成数据时，这可以节省大量的标注成本，尽管添加少量来自目标数据的标注示例可能仍能提升性能。</span></p><p><span>嵌入模型非常适合大规模评估非结构化数据中的典型事实。深度学习使得在经济研究中使用各种新颖的非结构化数据集成为可能。虽然我们的重点通常在于使用因果估计来检验精确定义的假设，但理解典型事实是制定这些假设的重要第一步。</span></p><p><span>考虑 Dell 等人 (2023) 的一个应用，该研究构建了一个历史报纸数据集，包含超过 4.3 亿篇美国历史报纸文章。该练习的目的是确定每年的最大新闻故事，而事先不知道这些故事是什么。该研究在来自 AllSides 的数据上对比训练了一个模型，AllSides 是一个现代新闻网站，将来自不同来源的新闻文章分组到故事中（通常对同一事件有不同的视角）。</span><sup class='md-footnote'><a href='#dfref-footnote-9' name='ref-footnote-9'>9</a></sup><span> 分组的故事形成训练的正例对，模型通过这些经验示例学习什么构成“同一故事”。训练后的模型用于嵌入文章，并通过聚类形成故事。表 3 报告了每年的最大聚类 (Dell et al. 2023)。出现了一些有趣的典型事实，特别是劳工运动的广泛报道。如果研究人员想要创建一个劳工运动的度量以用于因果估计方程，他们可能会训练一个具有精心制作标签的分类器来预测哪些文章是关于劳工运动的。相比之下，这个练习首先激发了为什么劳工运动值得研究。</span></p><p><span>Franklin 等人 (2024) 使用这个模型进行额外的数据探索，首先掩码所有命名实体（人物、组织、地点和其他杂项专有名词），然后在嵌入空间中查询与现代新闻文章查询最相似的历史新闻文章。由此产生的 News Déjà Vu 开源软件包和网站提供了一个探索人们对过去和现在感知相似性的新颖工具。</span></p><h3 id='85-光学字符识别'><span>8.5 光学字符识别</span></h3><p><span>OCR 对经济学家来说是一项重要任务，特别是对经济史学家而言。文档在字符集、语言、字体或手写体、印刷技术以及扫描和老化的伪影方面极其多样化。现成的 OCR 技术主要是为英语等高资源语言的小规模商业应用开发的，其使用的架构不太适合将 OCR 扩展到低资源语言和设置，如第 10 节所述。当偏离英语和其他少数高资源语言时，OCR 质量可能迅速恶化 (Carlson, Bryan, and Dell 2024; Hegghammer 2022)。例如，在 1950 年代的印刷日语文档上，表现最佳的现有 OCR 错误预测超过一半的字符。性能不佳很普遍，刺激了大量 OCR 后纠错文献 (Lyu et al. 2021; Nguyen et al. 2021; van Strien. et al. 2022)。</span></p><p><span>即使在最高资源的环境中，现成的解决方案仍然可能失败，特别是当准确性至关重要时。在转录定量数据时尤其如此。散文中的 OCR 错误通常在后处理中很容易纠正，或者无关紧要。然而，对于数字，类似的错误（例如，在数字开头幻觉出一个“1”）可能严重偏向下游统计分析。</span></p><p><span>此外，需要数字化的文档集合规模可能非常庞大。例如，美国国家档案和记录管理局保存了大约 132.8 亿页的文本记录。将大数据引入经济史需要一种既准确又部署成本低廉的 OCR 技术。</span></p><p><span>如果经济学家、历史学家和其他人仅仅依赖现成的商业技术，我们最终将专注于看起来很像高资源商业应用的经济应用（例如，英语收据）。这确实是我多年来与学生工作中看到的：他们更有可能放弃低资源语言的项目，因为任何现有现成解决方案的 OCR 质量都很差。这使经济知识偏向于看起来更像高资源商业应用的环境，这些环境不能代表人类社会的多样性。</span></p><p><span>为了应对这些挑战，Carlson, Bryan, and Dell (2024) 开发了一种新颖的开源 OCR 架构，EffOCR (EfficientOCR)。EffOCR 专为寻求针对多样化文档的样本高效、可定制、可扩展的 OCR 解决方案的研究人员和档案馆设计。基于深度学习的物体检测方法（第 9 节）用于定位文档图像中的单个字符或单词。字符或单词的识别模型经过对比训练——主要是在增强的数字字体上——以将同一字符或单词的图像裁剪映射到相似的向量表示，无论字体和其他变化如何。不同的字符或单词，即使它们具有非常相似的视觉外观，也被映射得更远。</span></p><p><span>通过嵌入单词或字符裁剪并检索它们在索引中的最近邻来转录文档，该索引嵌入了用数字字体渲染的裁剪。新字符或单词可以在训练后添加到索引中（与分类器不同），这对经济史学家来说是一个有用的功能，因为历史文档集合中经常出现特殊的符号。</span></p><p><span>EffOCR 表现非常准确，即使使用专为移动电话设计的轻量级模型，这些模型训练和部署成本低廉。例如，它可以为历史日语文档提供样本高效、高度准确的 OCR 架构，而所有当前解决方案都失败了。其准确性和高效运行时间的结合也使其对数字化高资源语言的大规模集合具有吸引力。Dell 等人 (2023) 使用 EffOCR 廉价地数字化了国会图书馆 Chronicling America 收藏的超过 4.3 亿篇历史报纸文章。TrOCR，一个具有类似准确性的开源解决方案，部署成本将高出近 50 倍，而商业解决方案的成本甚至更高。</span></p><p><span>EconDL 链接到一个演示笔记本，用于使用最少的云计算训练多调（古代）希腊语的自定义 OCR。Carlson, Bryan, and Dell (2024) 表明，该模型在目标数据上优于 Google Cloud Vision。该笔记本使用 EffOCR 软件包 (Bryan et al. 2023)，该软件包允许用户调优自己的 OCR 模型并运行现有的现成模型。EffOCR 不专注于手写体；然而，方法将是类似的。例如，合成手写体生成器，如 Bhunia 等人 (2021)，可以为预训练提供大量数据，类似于数字字体的使用。</span></p><h2 id='9-回归'><span>9. 回归</span></h2><p><span>在机器学习中，术语“回归”指的是连续结果的预测。使用深度神经网络的回归类似于分类，只是添加到神经网络中的回归层预测一个连续数字（或多个数字），而不是一组类别分数。因此，我们在这里的处理很简短，侧重于一个单一应用：物体检测。</span></p><p><span>物体检测问题，顾名思义，定位图像中的物体 (Ren et al. 2017; He et al. 2017; Kirillov et al. 2019; Cai and Vasconcelos 2019; Redmon et al. 2016; Ultralytics 2020; Carion et al. 2020; Liu et al. 2021)。例如，数字化公司财务记录的经济学家需要检测不同文档物体的坐标：例如，表头、列和行标题、表格单元格、脚注等。或者，希望从街景数据衡量非正规性的经济学家需要定位图像中的街头小贩。对于每个物体，神经网络输出四个连续数字（包含物体的框的左上角 x、左上角 y、高度和宽度）——一个回归问题——以及该物体的类别（例如，表头、列标题等）——一个分类问题。</span></p><p><span>图 10 展示了如何使用物体检测方法来定位和分类历史报纸扫描中的文档布局物体（例如，文章、标题等），促进创建可用于现代 NLP 方法分析的结构化数字文本。相比之下，图 11 提供了一个商业 OCR（Google Cloud Vision）如何像单列书籍一样读取报纸扫描的示例，未能检测到单个文章、标题等。使用这些混乱的文本，人们只能搜索关键词，正如使用历史报纸的经济学文献中常见的那样（参见 Beach and Hanlon 2022 的综述）。在数字化表格数据时，也需要布局检测来提取结构，如图 12 所示的历史日本公司记录。</span></p><p><span>目前，文档布局检测通常需要定制。如果目标任务非常接近其微调的目的，现成模型可能效果很好。然而，在计算机视觉中，主要的预训练数据集是 ImageNet，它由自然图像组成，例如不同品种的狗。模型没有在文档上进行大规模预训练，因此在应用于不同类型的文档时往往遭受显著的领域偏移。对于历史文档尤其如此，它们是异质的。</span></p><p><span>虽然有一个用于物体定位的基础模型，Meta AI 的 Segment Anything (Kirillov et al. 2023)，但在撰写本文时，我发现它对文档任务不是很有用。它可以定位图像中的物体，但不会将它们分类到类别中。此外，目前在文档图像上的定位不是特别准确。</span></p><p><span>开源软件包 Layout Parser (Shen et al. 2021) 降低了使用深度学习检测文档布局的障碍。该库包含一个用于现成使用的模型库，并便于调优定制模型，通过简单的 Python API 实现。更多信息可以在 EconDL 资源页面上找到。EconDL 知识库介绍了用于物体检测的主动学习 (Shen et al. forthcoming)，它选择模型最不确定的实例进行标注，以节省标注成本。</span></p><p><span>空间限制不允许深入探讨物体检测模型的架构，但 EconDL 知识库中的物体检测帖子提供了详细处理。卫星图像的资源包括，例如，Aleissaee 等人 (2023); Wang 等人 (2022); Bandara and Patel (2022); 以及 Fuller, Millard, and Green (2022)，并在 EconDL 的卫星图像处理页面上链接。</span></p><h2 id='10-替代方法'><span>10. 替代方法</span></h2><p><span>本综述侧重于一套在深度学习中占主导地位但远非全面的方法。如果读者深入研究深度学习文献，他们会发现处理上述问题的其他方法，并可能想知道为什么没有涵盖那些方法。我侧重于分类器和嵌入模型，因为它们通常是样本和计算高效的，这意味着它们可以从有限的数据中很好地学习，并且可以在受限硬件上廉价部署。它们易于训练，并且可以在各种任务上达到最先进的性能。</span></p><p><span>本节简要介绍了处理两个应用的其他方法：OCR 和实体消歧。它强调了问题可以如何不同地概念化，并强调了嵌入模型在学术应用中的一些优势。</span></p><h3 id='101-光学字符识别'><span>10.1 光学字符识别</span></h3><p><span>第 8.5 节将 OCR 框架为图像检索问题，使用对比训练的视觉模型。这与文献不同，文献大多将 OCR 建模为序列到序列 (seq2seq) 问题。Seq2seq 模型将一种数据序列转换为另一种序列。图 13 突出了 EffOCR 和 seq2seq 架构在 OCR 方面的差异。首先，seq2seq OCR 通常需要行级输入，不定位单个字符或单词。相反，它将文本行图像或其表示划分为固定大小的块。相比之下，EffOCR 使用现代物体检测方法 (Cai and Vasconcelos 2018; Jocher 2020) 来定位输入图像中的字符或单词。</span></p><p><span>其次，seq2seq 将图像表示——由学习到的视觉模型创建——使用学习到的语言模型顺序解码为文本。相反，EffOCR 采用对比训练 (Khosla et al. 2020) 来学习一个有意义的 OCR 度量空间。其视觉模型将同一字符或单词的裁剪投影到相近的位置，无论风格如何，同时将不同字符或单词的裁剪投影到不相似的嵌入。使用 EffOCR，仅视觉嵌入就足以通过从索引中检索其最近邻来推断文本。相比之下，使用 seq2seq，视觉表示使用语言模型解码为文本，这需要联合估计数百万个额外参数。</span></p><p><span>seq2seq 架构的一个缺点是，很难扩展和定制到新颖的设置 (Hedderich et al. 2021)，因为训练一个联合视觉-语言模型需要大量带标注的图像-文本对和显著的计算，特别是当使用最先进的架构时。TrOCR——一个由微软研究人员创建的 Transformer seq2seq 模型——使用 6.84 亿个英语合成文本行和 32 个 32GB V100 GPU 进行训练，这是一个非常昂贵的设置，没有学术研究人员能够复制。</span></p><p><span>这个缺点可以通过样本效率来量化，样本效率指的是模型在接触有限数量的训练示例后能够表现得多好。一些架构比其他架构学习更高效。双编码器倾向于高效学习，这对经济学家很重要，因为我们的计算和标注预算按深度学习标准严重受限。</span></p><p><span>图 14，取自 Carlson, Bryan, and Dell (2024)，通过在各种开源 OCR 架构上使用相同的小训练集进行训练来检查样本效率。x 轴绘制了训练中使用的 EffOCR 数据集的百分比，y 轴绘制了字符错误率。</span></p><p><span>仅使用 99 个标注的日语表格单元格和 21 个标注的来自 Chronicling America 收藏的美国报纸行以及数字字体（5% 的训练划分），EffOCR 的字符错误率约为 4%，显示了可行的少样本性能。其他架构，在相同数据上训练，仍然无法使用。EffOCR 使用 20% 的训练数据时表现几乎与使用 70% 时一样好，在后者情况下，它继续优于所有其他替代方案。TrOCR 从我们能够暴露给它的数据量中学到的东西几乎为零（因此为什么微软在 6.84 亿个文本行上训练它）。相比之下，EffOCR 可以在云中使用学生账户训练，甚至可以在笔记本电脑上训练。CRNN 是一种更轻量级、更老的 seq2seq 架构，在有限数据下学习更好，但使用 LSTM 而不是 Transformer，导致在完全训练时准确性下降。</span></p><p><span>嵌入模型也可以提供相对于 seq2seq 模型的计算优势。EffOCR 支持跨字符的推理并行化，促进更快的推理，而 seq2seq 需要自回归解码，速度较慢。EffOCR 运行速度大约比 TrOCR 快 50 倍，后者是唯一在完全训练后准确性相当的开源模型。我们使用 EffOCR 以 60,000 美元的预算创建了包含超过 4.3 亿篇历史新闻文章的开源 American Stories 数据集，并且实际上不可能产生任何额外的资金，更不用说 50 倍的资金了。</span></p><p><span>样本和计算高效的架构使得在各种环境和海量文档集合上实现高质量转录成为可能，将大数据带入多样化的经济史应用。理论上，从完整序列表示中获得上下文理解可以带来更好的 OCR。在实践中，最先进的 Transformer seq2seq 模型训练和部署成本高昂，并且不适用于低资源语言，进展主要在少数语言中。通过远离 seq2seq 模型，可以实现样本和计算效率的显著提升。在学术环境中，这样的优势尤其相关，因为我们的应用高度多样化，预算通常极其有限。</span></p><h3 id='102-实体消歧'><span>10.2 实体消歧</span></h3><p><span>实体消歧——将非结构化文本中的实体提及链接到外部知识库（如 Wikipedia）——导致了各种架构的发展。这些包括一个掩码语言模型 (LUKE, Yamada et al. 2022) 和一个神经翻译模型 (GENRE, De Cao et al. 2020)，后者使用序列到序列架构将提及翻译成 Wikipedia ID，以及将实体消歧视为最近邻检索问题的双编码器嵌入架构 (Wu et al. 2019)。后一种架构被本文的应用使用（第 8.3节）。</span></p><p><span>掩码语言模型方法掩码实体并使用分类器头预测其 Wikipedia ID。虽然它在一些基准测试中领先，但在实践中具有主要局限性。语言模型通过分类预测被掩码的词元。LUKE 仅限于前 50,000 个 Wikipedia 条目，由于计算 softmax 的计算限制。前 50,000 个条目中的许多不是人物，并且许多出现在历史新闻或政府文件中的人物不在前 50,000 名中。此外，它不能容纳知识库外的实体，并且需要稀疏实体先验来初始化模型。在许多应用中，并非所有个人都会在知识库中，模型需要能够预测这一点。</span></p><p><span>神经翻译模型的序列到序列架构在推理过程中速度慢，运行时间大约比双编码器嵌入模型长 60 倍。Arora, Silcock 等人 (2024) 还表明，嵌入模型在消歧历史文本方面实现了更高的准确性。简而言之，再次，序列到序列架构在大规模运行时成本高昂，并且不一定提供性能优势。</span></p><h2 id='11-结论'><span>11. 结论</span></h2><p><span>深度学习为处理非结构化数据提供了强大的工具。在从文本分类到记录链接、实体消歧和追踪复制内容传播的社会科学任务上，深度学习可以大大优于传统的稀疏方法（通常 F1/准确率高出 20 分或更多）(Silcock et al. 2022; Dell et al. 2023; Arora and Dell 2024; Arora, Silcock et al. 2024; Arora, Yang et al. 2024)。</span></p><p><span>深度学习可以通过提供从非结构化数据中大规模推算结构化信息的工具，促进新颖的分析。当使用轻量级、样本高效的预训练模型时，训练和部署相当经济，即使对于具有数百万或数十亿观测值的数据集也是如此。对于一些应用，深度学习也为处理来自低资源环境的数据提供了前景，有可能使经济研究更能代表人类社会的多样性。</span></p><p><span>熟悉深度学习方法需要显著的启动成本。本文——以及配套的开源软件包、教程和知识库——旨在显著降低希望在研究中使用深度学习的经济学家的入门门槛。</span></p><hr /><h2 id='正文图表'><span>正文图表</span></h2><ul><li><span>Figure 1. Flowchart for Approaching Classification | 图1. 处理分类问题的流程图</span></li><li><span>Figure 2. Classifying Text | 图2. 文本分类</span></li><li><span>Figure 3. Tasks Performed with a Transformer Encoder Language Model | 图3. 使用Transformer编码器语言模型执行的任务</span></li><li><span>Figure 4. Share of Newswire Articles with a Given Binary Topic Tag | 图4. 带有给定二元主题标签的新闻专线文章比例</span></li><li><span>Figure 5. Shares of Entity Types in Newswire Articles | 图5. 新闻专线文章中实体类型的比例</span></li><li><span>Figure 6. Architectures to Compare Texts | 图6. 比较文本的架构</span></li><li><span>Figure 7. Embedding Similarities within and across Topics | 图7. 主题内和主题间的嵌入相似度</span></li><li><span>Figure 8. LinkTransformer Architecture | 图8. LinkTransformer 架构</span></li><li><span>Figure 9. Character Similarity as Measured by Vision Transformers | 图9. 视觉Transformer测量的字符相似度</span></li><li><span>Figure 10. Layouts from Historical Newspapers | 图10. 历史报纸的布局</span></li><li><span>Figure 11. Layouts as Detected by Google Cloud Vision | 图11. Google Cloud Vision 检测到的布局</span></li><li><span>Figure 12. Document Layouts | 图12. 文档布局</span></li><li><span>Figure 13. EffOCR and Seq2Seq Model Architectures | 图13. EffOCR 和 Seq2Seq 模型架构</span></li><li><span>Figure 14. Sample Efficiency | 图14. 样本效率</span></li><li><span>Table 1. Applications | 表1. 应用</span></li><li><span>Table 2. F1 on Test Set and Summary of Train–Test Split | 表2. 测试集上的F1分数及训练-测试划分摘要</span></li><li><span>Table 3. Biggest News Stories | 表3. 最大的新闻故事</span></li><li><span>Table A1. Prompts Used to Query OpenAI GPT Models | 表A1. 用于查询OpenAI GPT模型的提示</span></li></ul><div class='footnotes-area'  ><hr/>
<div class='footnote-line'><span class='md-fn-count'>1</span> <span>访问 </span><a href='https://doi.org/10.1257/jel.20241733' target='_blank' class='url'>https://doi.org/10.1257/jel.20241733</a><span> 查看文章页面并查看作者披露声明。</span> <a name='dfref-footnote-1' href='#ref-footnote-1' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>2</span> <span>哈佛大学经济系和美国国家经济研究局 (NBER)。我要感谢四位匿名审稿人、David Romer 和 Jake Carlson 的有益评论和建议。Yiyang Chen 提供了出色的研究协助。</span> <a name='dfref-footnote-2' href='#ref-footnote-2' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>3</span> <span>在撰写本文时，将 top_p 设置为 0 会使 GPT 具有确定性。</span> <a name='dfref-footnote-3' href='#ref-footnote-3' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>4</span> <span>政治分类器来自一篇已发表的论文 (Dell et al. 2023)，其目标不同，因此划分比例和总标注数量略有不同。</span> <a name='dfref-footnote-4' href='#ref-footnote-4' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>5</span> <span>CoNLL 代表计算自然语言学习会议，WNUT 代表嘈杂和用户生成文本研讨会。两者都以它们被提出的会议场所命名。</span> <a name='dfref-footnote-5' href='#ref-footnote-5' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>6</span> <span>此外，如果我们要求交叉编码器分类 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewBox="0 -441 529 451" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-103-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-103-TEX-I-1D44E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">a</script><span> 是否与 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.971ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 429 705" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-101-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D44F" xlink:href="#MJX-101-TEX-I-1D44F"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">b</script><span> 相同，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.971ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 429 705" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-101-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D44F" xlink:href="#MJX-101-TEX-I-1D44F"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">b</script><span> 是否与 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 433 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-104-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D450" xlink:href="#MJX-104-TEX-I-1D450"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">c</script><span> 相同，以及 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewBox="0 -441 529 451" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-103-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-103-TEX-I-1D44E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">a</script><span> 是否与 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="0.98ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 433 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-104-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D450" xlink:href="#MJX-104-TEX-I-1D450"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">c</script><span> 相同，可能会导致非传递性。</span> <a name='dfref-footnote-6' href='#ref-footnote-6' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>7</span> <span>使用汇集表示而不是 </span><code>&lt;cls&gt;</code><span> 词元，因为这已被证明具有更好的性能 (Reimers and Gurevych 2019)。</span> <a name='dfref-footnote-7' href='#ref-footnote-7' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>8</span> <span>其他常见的聚类方法，如层次凝聚聚类，不能很好地扩展。</span> <a name='dfref-footnote-8' href='#ref-footnote-8' title='回到文档' class='reversefootnote' >↩</a></div>
<div class='footnote-line'><span class='md-fn-count'>9</span> <span>参见 </span><a href='https://www.allsides.com/unbiased-balanced-news' target='_blank' class='url'>https://www.allsides.com/unbiased-balanced-news</a> <a name='dfref-footnote-9' href='#ref-footnote-9' title='回到文档' class='reversefootnote' >↩</a></div></div></div></div>
</body>
</html>